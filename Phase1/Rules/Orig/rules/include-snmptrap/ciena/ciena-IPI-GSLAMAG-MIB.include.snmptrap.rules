###############################################################################
#
#    Licensed Materials - Property of IBM
#
#    (C) Copyright IBM Corp. 2006
#    All Rights Reserved
#
#    ciena-IPI-GSLAMAG-MIB.include.snmptrap.rules 1.0 
#    2005/12/05 Robert Cowart
#
###############################################################################
###############################################################################
#
# 1.0 - Initial Release.
#
#        Compatible with:
#
#          -  Netcool/Omnibus 3.x and 7
#          -  Netcool Rules File Standards (MUSE-STD-RF-02, July 2002)
#
#          -  IPI-GSLAMAG-MIB
#
###############################################################################

case ".1.3.6.1.4.1.7737.7.2.9.3.2": ### Ciena (formerly Internet Photonics) CN4200 GSLAM-AG - Notifications from IPI-GSLAMAG-MIB

    log(DEBUG, "<<<<< Entering... ciena-IPI-GSLAMAG-MIB.include.snmptrap.rules >>>>>")

    @Agent = "Ciena-CN4200"
    @Class = "40506"

    $OPTION_TypeFieldUsage = "3.6"

    switch($specific-trap)
    {
        case "1": ### cn4200NotificationAIS

            ##########
            # $1 = cn4200NotificationHelperPEOID 
            # $2 = cn4200NotificationHelperPEType 
            # $3 = cn4200NotificationHelperAction
            # $4 = cn4200NotificationHelperSev
            # $5 = cn4200NotificationDesc
            # $6 = cn4200NotificationHelperServiceIndicator 
            # $7 = cn4200NotificationAffectedLP 
            # $8 = cn4200NotificationAffectedSourceIP 
            # $9 = cn4200NotificationHelperPEAID
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationAffectedLP = $7
            $cn4200NotificationAffectedSourceIP = $8
            $cn4200NotificationHelperPEAID = $9
            
            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationAIS"

            @AlertGroup = "AIS Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Alarm Iindication Signal"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( Affected LP: " + $7 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }
            
            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap

            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "2": ### cn4200NotificationBATTERY

            ##########
            # $1 = cn4200NotificationHelperPEOID
            # $2 = cn4200NotificationHelperPEType
            # $3 = cn4200NotificationHelperAction
            # $4 = cn4200NotificationHelperSev 
            # $5 = cn4200NotificationDesc
            # $6 = cn4200NotificationHelperPEAID
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationBATTERY"

            @AlertGroup = "Battery Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Battery Failure  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID, $cn4200NotificationHelperPEType, $cn4200NotificationHelperAction, $cn4200NotificationHelperSev, $cn4200NotificationDesc, $cn4200NotificationHelperPEAID)
            
        case "3": ### cn4200NotificationCGM

            ##########
            # $1 = cn4200NotificationHelperPEOID 
            # $2 = cn4200NotificationHelperPEType 
            # $3 = cn4200NotificationHelperAction
            # $4 = cn4200NotificationHelperSev
            # $5 = cn4200NotificationDesc
            # $6 = cn4200NotificationHelperServiceIndicator 
            # $7 = cn4200NotificationAffectedLP
            # $8 = cn4200NotificationAffectedSourceIP
            # $9 = cn4200NotificationHelperPEAID
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationAffectedLP = $7
            $cn4200NotificationAffectedSourceIP = $8
            $cn4200NotificationHelperPEAID = $9

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationCGM"

            @AlertGroup = "Concatenation Group Match Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Concatenation Group Mismatch"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( Affected LP: " + $7 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "4": ### cn4200NotificationCLFAN

            ##########
            # $1 = cn4200NotificationHelperPEOID
            # $2 = cn4200NotificationHelperPEType
            # $3 = cn4200NotificationHelperAction
            # $4 = cn4200NotificationHelperSev
            # $5 = cn4200NotificationDesc 
            # $6 = cn4200NotificationHelperServiceIndicator
            # $7 = cn4200NotificationHelperPEAID
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationHelperPEAID = $7

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationCLFAN"

            @AlertGroup = "Cooling Fan Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Cooling Fan Failure"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationHelperPEAID)
            
        case "5": ### cn4200NotificationEOC

            ##########
            # $1 = cn4200NotificationHelperPEOID
            # $2 = cn4200NotificationHelperPEType
            # $3 = cn4200NotificationHelperAction 
            # $4 = cn4200NotificationHelperSev
            # $5 = cn4200NotificationDesc
            # $6 = cn4200NotificationHelperPEAID 
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationEOC"

            @AlertGroup = "Embedded Operations Channel Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Embedded Operations Channel Failure  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }
            
            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "6": ### cn4200NotificationEQPT

            ##########
            # Equipment failure/cleared.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationHelperPEAID = $7

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationEQPT"

            @AlertGroup = "Equipment Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Equipment Failure"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationHelperPEAID)

        case "7": ### cn4200NotificationEXTCONT

            ##########
            # External condition activated.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationEXTCONT"

            @AlertGroup = "External Condition Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "External Condition Activated  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "8": ### cn4200NotificationFA

            ##########
            # Fuse alarm/cleared.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationFA"

            @AlertGroup = "Fuse Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Fuse Alarm  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "9": ### cn4200NotificationFACTERM

            ##########
            # Facility/circuit termination equipment failure/cleared.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $8 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $9 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationAffectedLP = $7
            $cn4200NotificationAffectedSourceIP = $8
            $cn4200NotificationHelperPEAID = $9

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationFACTERM"

            @AlertGroup = "Facility/Circuit Termination Equipment Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Facility/Circuit Termination Equipment Failure"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( Affected LP: " + $7 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "10": ### cn4200NotificationFRCDWKSWPR

            ##########
            # Forced working switch to protection/cleared.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationFRCDWKSWPR"

            @AlertGroup = "Working Switch Protection Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Forced Working Switch to Protection  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "11": ### cn4200NotificationFREEMEMLOW

            ##########
            # Free memory low.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationFREEMEMLOW"

            @AlertGroup = "Free Memory Status"
            @AlertKey = ""
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Free Memory Low  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "12": ### cn4200NotificationFRNGSYNC

            ##########
            # Free running synchronization mode/cleared.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationFRNGSYNC"

            @AlertGroup = "Synchronization Mode Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Free Running Synchronization Mode  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "13": ### cn4200NotificationHITEMP

            ##########
            # High temperature/cleared.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationHelperPEAID = $7

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationHITEMP"

            @AlertGroup = "High Temperature Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "High Temperature"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationHelperPEAID)

        case "14": ### cn4200NotificationIMPROPMVL

            ##########
            # Improper removal/cleared.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationHelperPEAID = $7

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationIMPROPMVL"

            @AlertGroup = "Removal Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Improper Removal"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationHelperPEAID)

        case "15": ### cn4200NotificationINIT

            ##########
            # Initialization level x will be executed.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationInitLevel - Indicates the initialization
            #        level.
            # $7 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $8 = cn4200NotificationHelperPEAID - Used in the variable
            #         binding of some gslamAG notification to indicate the AID
            #         of the entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationInitLevel = $6
            $cn4200NotificationHelperServiceIndicator = lookup($7, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationHelperPEAID = $8

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationINIT"

            @AlertGroup = "Initialization Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Initialization: " + $5
            switch($7)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }
            
            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $5
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $7 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationInitLevel,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationHelperPEAID)

        case "16": ### cn4200NotificationLCK

            ##########
            # Channel administratively locked.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $8 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $9 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationAffectedLP = $7
            $cn4200NotificationAffectedSourceIP = $8
            $cn4200NotificationHelperPEAID = $9

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationLCK"

            @AlertGroup = "Channel Lock Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Channel Administratively Locked"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( Affected LP: " + $7 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "17": ### cn4200NotificationLOCKOUTOFPR

            ##########
            # Lockout of protection.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $8 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $9 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationAffectedLP = $7
            $cn4200NotificationAffectedSourceIP = $8
            $cn4200NotificationHelperPEAID = $9

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationLOCKOUTOFPR"

            @AlertGroup = "Protection Lock Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Lockout of Protection"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( Affected LP: " + $7 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "18": ### cn4200NotificationLOF

            ##########
            # Loss of frame/cleared.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationHelperPEAID = $7

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationLOF"

            @AlertGroup = "Frame Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Loss of Frame"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationHelperPEAID)

        case "19": ### cn4200NotificationLOGBUFROVFL

            ##########
            # Log buffer overflow.
            #
            # $1 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $2 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $3 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $4 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $5 = cn4200NotificationLogName - Used in the variable binding of
            #        some mxa notification to indicate the log name in the
            #        GSLAM-AG notification.
            ##########

            $cn4200NotificationHelperPEType = lookup($1, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($2, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $2 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($3, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $3 + " )"
            $cn4200NotificationDesc = $4
            $cn4200NotificationLogName = $5

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationLOGBUFROVFL"

            @AlertGroup = "Log Buffer Status"
            @AlertKey = "Log: " + $5
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Log Buffer Overflow  ( " + @AlertKey + " )"

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $1 + " )"
            details($cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationLogName)

        case "20": ### cn4200NotificationLOGBUFRTH

            ##########
            # Log buffer usage above threshold.
            #
            # $1 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $2 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $3 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $4 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $5 = cn4200NotificationLogName - Used in the variable binding of
            #        some mxa notification to indicate the log name in the
            #        GSLAM-AG notification.
            ##########

            $cn4200NotificationHelperPEType = lookup($1, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($2, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $2 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($3, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $3 + " )"
            $cn4200NotificationDesc = $4
            $cn4200NotificationLogName = $5

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationLOGBUFRTH"

            @AlertGroup = "Log Buffer Usage Threshold"
            @AlertKey = "Log: " + $5
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Log Buffer Usage Exceeds Threshold  ( " + @AlertKey + " )"

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $1 + " )"
            details($cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationLogName)

        case "21": ### cn4200NotificationLOM

            ##########
            # Loss of multiframe.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $8 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $9 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationAffectedLP = $7
            $cn4200NotificationAffectedSourceIP = $8
            $cn4200NotificationHelperPEAID = $9

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationLOM"

            @AlertGroup = "Multiframe Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Loss of Multiframe"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( Affected LP: " + $7 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "22": ### cn4200NotificationLOP

            ##########
            # Loss of pointer.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $8 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $9 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationAffectedLP = $7
            $cn4200NotificationAffectedSourceIP = $8
            $cn4200NotificationHelperPEAID = $9

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationLOP"

            @AlertGroup = "Pointer Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Loss of Pointer"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( Affected LP: " + $7 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "23": ### cn4200NotificationLOS

            ##########
            # Loss of signal/cleared.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationHelperPEAID = $7

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationLOS"

            @AlertGroup = "Signal Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Loss of Signal"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationHelperPEAID)

        case "24": ### cn4200NotificationLPBKFACILITY

            ##########
            # Loop back, Facility/cleared.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $7 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $8 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationAffectedLP = $6
            $cn4200NotificationAffectedSourceIP = $7
            $cn4200NotificationHelperPEAID = $8

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationLPBKFACILITY"

            @AlertGroup = "Facility Loopback Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Facility Looped Back  ( Affected LP: " + $6 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "25": ### cn4200NotificationLPBKTERM

            ##########
            # Loop back, Terminal/cleared.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationLPBKTERM"

            @AlertGroup = "Terminal Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Terminal Looped Back  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "26": ### cn4200NotificationMANWKSWPR

            ##########
            # Manual switch to protection.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationMANWKSWPR"

            @AlertGroup = "Manual Protection Switch Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Manual Switch to Protection  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "27": ### cn4200NotificationMISC

            ##########
            # Miscellaneous condition.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationHelperPEAID = $7

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationMISC"

            @AlertGroup = "Miscellaneous Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Miscellaneous Condition"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationHelperPEAID)

        case "28": ### cn4200NotificationNDPLNK

            ##########
            # NDP neighbor link cabling error.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationHelperPEAID = $7

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationNDPLNK"

            @AlertGroup = "NDP Neighbor Link Cabling Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "NDP Neighbor Link Cabling Error"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationHelperPEAID)

        case "29": ### cn4200NotificationNDPLNKUP

            ##########
            # Neighbor link up.
            #
            # $1 = gslamAGExternalConnectionLocalIP - Indicates the IP address
            #        of the local end of this external connection.
            # $2 = gslamAGExternalConnectionLocalUMIC - Indicates the UMIC
            #        value of the local end of this external connection.
            # $3 = cn4200NotificationHelperLocalPEType - Used in the variable
            #        binding of NDP link up/down trap to indicate the type of
            #        the local physical entity involved.
            # $4 = cn4200NotificationHelperLocalPEOID - Used in the variable
            #        binding of NDP link up/down trap to indicate the OID of
            #        the local physical entity involved.
            # $5 = gslamAGExternalConnectionRemoteNodeIP - Indicates the IP
            #        address of the remote node of this external connection.
            # $6 = gslamAGExternalConnectionRemoteIP - Indicates the IP address
            #        of the remote end of this external connection.
            # $7 = gslamAGExternalConnectionRemoteUMIC - Indicates the UMIC
            #        value of the remote end of this external connection.
            # $8 = gslamAGExternalConnectionRemoteNodeType - Indicates the
            #        equiptment type of the remote end of this external
            #        connection.
            # $9 = gslamAGExternalConnectionLocalNodeTID - Indicates the TID of
            #        the local end of this external connection.
            # $10 = gslamAGExternalConnectionRemoteNodeTID - Indicates the TID
            #         of the remote end of this external connection.
            # $11 = cn4200NotificationDesc - Indicates the detailed description
            #         of the gslamAG notification.
            # $12 = cn4200NotificationHelperPEAID - Used in the variable
            #        binding of some gslamAG notification to indicate the AID
            #        of the entity involved in the notification.
            ##########

            $gslamAGExternalConnectionLocalIP = $1
            $gslamAGExternalConnectionLocalUMIC = $2
            $cn4200NotificationHelperLocalPEType = lookup($3, cn4200EquipmentTypeValue)
            $cn4200NotificationHelperLocalPEOID = $4
            $gslamAGExternalConnectionRemoteNodeIP = $5
            $gslamAGExternalConnectionRemoteIP = $6
            $gslamAGExternalConnectionRemoteUMIC = $7
            $gslamAGExternalConnectionRemoteNodeType = lookup($8, cn4200RemoteNodeTypeValue) + " ( " + $8 + " )"
            $gslamAGExternalConnectionLocalNodeTID = $9
            $gslamAGExternalConnectionRemoteNodeTID = $10
            $cn4200NotificationDesc = $11
            $cn4200NotificationHelperPEAID = $12
            
            $gslamAGShelfIndex = extract($OID1, "\.([0-9]+)\.[0-9]+\.[0-9]+$")
            $gslamAGIOModuleIndex = extract($OID1, "\.([0-9]+)\.[0-9]+$")
            $gslamAGPortIndex = extract($OID1, "\.([0-9]+)$")
            
            ##########
            # UMICValue - Indicate a unique ID identifying a port or channel.
            # Each UMIC is a 32-bit unsigned interger. From left (most
            # significant) to right, we allocate 4 bits for unit(shelf) id, 8
            # bits for IO module id, 8 bits for interface(port) id, and the
            # rest (rightmost) 12 bits for channel id.
            ##########
            
            $ConnectionLocalUMICShelf = (int($2) & 4026531840) >> 28
            $ConnectionLocalUMICModule = (int($2) & 267386880) >> 20
            $ConnectionLocalUMICPort = (int($2) & 1044480) >> 12
            $ConnectionLocalUMICChannel = (int($2) & 4095)
            
            $ConnectionRemoteUMICShelf = (int($7) & 4026531840) >> 28
            $ConnectionRemoteUMICModule = (int($7) & 267386880) >> 20
            $ConnectionRemoteUMICPort = (int($7) & 1044480) >> 12
            $ConnectionRemoteUMICChannel = (int($7) & 4095)

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationNDPLNKUP"

            @AlertGroup = "NDP Neighbor Link Status"
            @AlertKey = "gslamAGExternalConnectionEntry." + $gslamAGShelfIndex + "." + $gslamAGIOModuleIndex + "." + $gslamAGPortIndex
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "NDP Neighbor Link Up  ( Neighbor: " + $5 + " )"

            $DEFAULT_Severity = 1
            $DEFAULT_Type = 2
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            details($gslamAGExternalConnectionLocalIP,$gslamAGExternalConnectionLocalUMIC,$cn4200NotificationHelperLocalPEType,$cn4200NotificationHelperLocalPEOID,$gslamAGExternalConnectionRemoteNodeIP,$gslamAGExternalConnectionRemoteIP,$gslamAGExternalConnectionRemoteUMIC,$gslamAGExternalConnectionRemoteNodeType,$gslamAGExternalConnectionLocalNodeTID,$gslamAGExternalConnectionRemoteNodeTID,$cn4200NotificationDesc,$gslamAGShelfIndex,$gslamAGIOModuleIndex,$gslamAGPortIndex,$ConnectionLocalUMICShelf,$ConnectionLocalUMICModule,$ConnectionLocalUMICPort,$ConnectionLocalUMICChannel,$ConnectionRemoteUMICShelf,$ConnectionRemoteUMICModule,$ConnectionRemoteUMICPort,$ConnectionRemoteUMICChannel,$cn4200NotificationHelperPEAID)

        case "30": ### cn4200NotificationNDPLNKDN

            ##########
            # Neighbor link down.
            #
            # $1 = gslamAGExternalConnectionLocalIP - Indicates the IP address
            #        of the local end of this external connection.
            # $2 = gslamAGExternalConnectionLocalUMIC - Indicates the UMIC
            #        value of the local end of this external connection.
            # $3 = cn4200NotificationHelperLocalPEType - Used in the variable
            #        binding of NDP link up/down trap to indicate the type of
            #        the local physical entity involved.
            # $4 = cn4200NotificationHelperLocalPEOID - Used in the variable
            #        binding of NDP link up/down trap to indicate the OID of
            #        the local physical entity involved.
            # $5 = gslamAGExternalConnectionRemoteNodeIP - Indicates the IP
            #        address of the remote node of this external connection.
            # $6 = gslamAGExternalConnectionRemoteIP - Indicates the IP address
            #        of the remote end of this external connection.
            # $7 = gslamAGExternalConnectionRemoteUMIC - Indicates the UMIC
            #        value of the remote end of this external connection.
            # $8 = gslamAGExternalConnectionRemoteNodeType - Indicates the
            #        equiptment type of the remote end of this external
            #        connection.
            # $9 = gslamAGExternalConnectionLocalNodeTID - Indicates the TID of
            #        the local end of this external connection.
            # $10 = gslamAGExternalConnectionRemoteNodeTID - Indicates the TID
            #         of the remote end of this external connection.
            # $11 = cn4200NotificationDesc - Indicates the detailed description
            #         of the gslamAG notification.
            # $12 = cn4200NotificationHelperPEAID - Used in the variable
            #         binding of some gslamAG notification to indicate the AID
            #         of the entity involved in the notification.
            ##########

            $gslamAGExternalConnectionLocalIP = $1
            $gslamAGExternalConnectionLocalUMIC = $2
            $cn4200NotificationHelperLocalPEType = lookup($3, cn4200EquipmentTypeValue)
            $cn4200NotificationHelperLocalPEOID = $4
            $gslamAGExternalConnectionRemoteNodeIP = $5
            $gslamAGExternalConnectionRemoteIP = $6
            $gslamAGExternalConnectionRemoteUMIC = $7
            $gslamAGExternalConnectionRemoteNodeType = lookup($8, cn4200RemoteNodeTypeValue) + " ( " + $8 + " )"
            $gslamAGExternalConnectionLocalNodeTID = $9
            $gslamAGExternalConnectionRemoteNodeTID = $10
            $cn4200NotificationDesc = $11
            $cn4200NotificationHelperPEAID = $12

            $gslamAGShelfIndex = extract($OID1, "\.([0-9]+)\.[0-9]+\.[0-9]+$")
            $gslamAGIOModuleIndex = extract($OID1, "\.([0-9]+)\.[0-9]+$")
            $gslamAGPortIndex = extract($OID1, "\.([0-9]+)$")
            
            ##########
            # UMICValue - Indicate a unique ID identifying a port or channel.
            # Each UMIC is a 32-bit unsigned interger. From left (most
            # significant) to right, we allocate 4 bits for unit(shelf) id, 8
            # bits for IO module id, 8 bits for interface(port) id, and the
            # rest (rightmost) 12 bits for channel id.
            ##########
            
            $ConnectionLocalUMICShelf = (int($2) & 4026531840) >> 28
            $ConnectionLocalUMICModule = (int($2) & 267386880) >> 20
            $ConnectionLocalUMICPort = (int($2) & 1044480) >> 12
            $ConnectionLocalUMICChannel = (int($2) & 4095)
            
            $ConnectionRemoteUMICShelf = (int($7) & 4026531840) >> 28
            $ConnectionRemoteUMICModule = (int($7) & 267386880) >> 20
            $ConnectionRemoteUMICPort = (int($7) & 1044480) >> 12
            $ConnectionRemoteUMICChannel = (int($7) & 4095)

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationNDPLNKDN"

            @AlertGroup = "NDP Neighbor Link Status"
            @AlertKey = "gslamAGExternalConnectionEntry." + $gslamAGShelfIndex + "." + $gslamAGIOModuleIndex + "." + $gslamAGPortIndex
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "NDP Neighbor Link Down  ( Neighbor: " + $5 + " )"

            $DEFAULT_Severity = 4
            $DEFAULT_Type = 1
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            details($gslamAGExternalConnectionLocalIP,$gslamAGExternalConnectionLocalUMIC,$cn4200NotificationHelperLocalPEType,$cn4200NotificationHelperLocalPEOID,$gslamAGExternalConnectionRemoteNodeIP,$gslamAGExternalConnectionRemoteIP,$gslamAGExternalConnectionRemoteUMIC,$gslamAGExternalConnectionRemoteNodeType,$gslamAGExternalConnectionLocalNodeTID,$gslamAGExternalConnectionRemoteNodeTID,$cn4200NotificationDesc,$gslamAGShelfIndex,$gslamAGIOModuleIndex,$gslamAGPortIndex,$ConnectionLocalUMICShelf,$ConnectionLocalUMICModule,$ConnectionLocalUMICPort,$ConnectionLocalUMICChannel,$ConnectionRemoteUMICShelf,$ConnectionRemoteUMICModule,$ConnectionRemoteUMICPort,$ConnectionRemoteUMICChannel,$cn4200NotificationHelperPEAID)

        case "31": ### cn4200NotificationNDP

            ##########
            # NDP neighbor discovery misconfiguration.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationNDP"

            @AlertGroup = "NDP Neighbor Discovery Config. Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "NDP Neighbor Discovery Misconfiguration  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "32": ### cn4200NotificationNTPSYNC

            ##########
            # NTP sync failure.
            #
            # $1 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $2 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $3 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $4 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            ##########

            $cn4200NotificationHelperPEType = lookup($1, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($2, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $2 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($3, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $3 + " )"
            $cn4200NotificationDesc = $4

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationNTPSYNC"

            @AlertGroup = "NTP Syncronization Status"
            @AlertKey = ""
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "NTP Syncronization Failure"

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $1 + " )"
            details($cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc)

        case "33": ### cn4200NotificationOCI

            ##########
            # Open matrix connection defect/cleared.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $8 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $9 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationAffectedLP = $7
            $cn4200NotificationAffectedSourceIP = $8
            $cn4200NotificationHelperPEAID = $9

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationOCI"

            @AlertGroup = "Open Matrix Connection Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Open Matrix Connection Defect"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( Affected LP: " + $7 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "34": ### cn4200NotificationOSLINK

            ##########
            # Management Link has failed/recovered.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationOSLINK"

            @AlertGroup = "Management Link Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Management Link Failed  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "35": ### cn4200NotificationPDI

            ##########
            # Payload defect indication/cleared.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $8 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $9 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationAffectedLP = $7
            $cn4200NotificationAffectedSourceIP = $8
            $cn4200NotificationHelperPEAID = $9

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationPDI"

            @AlertGroup = "Payload Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Payload Defect Indication"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( Affected LP: " + $7 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "36": ### cn4200NotificationPLM

            ##########
            # Payload label mismatch for path.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationHelperPEAID = $7

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationPLM"

            @AlertGroup = "Payload Label Match Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Payload Label Mismatch for Path"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationHelperPEAID)

        case "37": ### cn4200NotificationPRCDRERR

            ##########
            # Procedure error, mismatch of attributes/cleared.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $8 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $9 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationAffectedLP = $7
            $cn4200NotificationAffectedSourceIP = $8
            $cn4200NotificationHelperPEAID = $9

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationPRCDRERR"

            @AlertGroup = "Procedure Attribute Match Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Procedure Error, Attribute Mismatch"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( Affected LP: " + $7 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "38": ### cn4200NotificationPWRRESTART

            ##########
            # Power fail restart.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationPWRRESTART"

            @AlertGroup = "Power Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Power Fail Restart  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "39": ### cn4200NotificationRFI

            ##########
            # Remote failure indication/cleared.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationHelperPEAID = $7

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationRFI"

            @AlertGroup = "Remote Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Remote Failure Indication"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationHelperPEAID)

        case "40": ### cn4200NotificationROLL

            ##########
            # Roll in progress/cleared.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationROLL"

            @AlertGroup = "Roll Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Roll in Progress  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "41": ### cn4200NotificationSDBER

            ##########
            # Signal degrade due to BER.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationHelperPEAID = $7

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationSDBER"

            @AlertGroup = "Signal BER Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Signal Degrade Due to BER"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationHelperPEAID)

        case "42": ### cn4200NotificationSFBER

            ##########
            # Signal failure due to BER.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $8 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $9 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationAffectedLP = $7
            $cn4200NotificationAffectedSourceIP = $8
            $cn4200NotificationHelperPEAID = $9

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationSFBER"

            @AlertGroup = "Signal BER Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Signal Failure Due to BER"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( Affected LP: " + $7 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "43": ### cn4200NotificationSFT

            ##########
            # Software or operating system/cleared.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationSFT"

            @AlertGroup = "Software Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Software or Operating System Alarm  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "44": ### cn4200NotificationSFTWDN

            ##########
            # Software download in progress/cleared.
            #
            # $1 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $2 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $3 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $4 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            ##########

            $cn4200NotificationHelperPEType = lookup($1, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($2, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $2 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($3, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $3 + " )"
            $cn4200NotificationDesc = $4

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationSFTWDN"

            @AlertGroup = "Software Download Status"
            @AlertKey = ""
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Software Download In Progress"

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $1 + " )"
            details($cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc)

        case "45": ### cn4200NotificationSYNC

            ##########
            # Loss of timing on synchronization link/cleared.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationSYNC"

            @AlertGroup = "Synchronization Link Timing Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Loss of Timing on Synchronization Link  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "46": ### cn4200NotificationTHSHVLT

            ##########
            # Threshold violation.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationMonTypeAndDir - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        monitor type in the GSLAM-AG notification.
            # $7 = cn4200NotificationHelperMonValue - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        monitor value.
            # $8 = cn4200NotificationHelperMonThreshold - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        threshold value.
            # $9 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationMonTypeAndDir = $6
            $cn4200NotificationHelperMonValue = $7
            $cn4200NotificationHelperMonThreshold = $8
            $cn4200NotificationHelperPEAID = $9

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationTHSHVLT"

            @AlertGroup = "Threshold Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Threshold Violation  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationMonTypeAndDir,$cn4200NotificationHelperMonValue,$cn4200NotificationHelperMonThreshold,$cn4200NotificationHelperPEAID)

        case "47": ### cn4200NotificationTIM

            ##########
            # Trace identifier message defect/cleared.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $8 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $9 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationAffectedLP = $7
            $cn4200NotificationAffectedSourceIP = $8
            $cn4200NotificationHelperPEAID = $9

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationTIM"

            @AlertGroup = "Trace Identifier Message Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Trace Identifier Message Defect"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( Affected LP: " + $7 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "48": ### cn4200NotificationREBOOTED

            ##########
            # Reboot completed.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $8 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $9 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationAffectedLP = $7
            $cn4200NotificationAffectedSourceIP = $8
            $cn4200NotificationHelperPEAID = $9

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationREBOOTED"

            @AlertGroup = "Reboot Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Reboot Completed"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( Affected LP: " + $7 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "49": ### cn4200NotificationWKSWPR

            ##########
            # Protection switch event.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationWKSWPR"

            @AlertGroup = "Protection Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Protection Switch  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "50": ### cn4200NotificationWTR

            ##########
            # Wait-to-Restore Interval.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationWTR"

            @AlertGroup = "Wait-to-Restore Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Wait-to-Restore Interval  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "51": ### cn4200NotificationACO

            ##########
            # Alarm cutoff active.
            #
            # $1 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $2 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $3 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $4 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            ##########

            $cn4200NotificationHelperPEType = lookup($1, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($2, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $2 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($3, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $3 + " )"
            $cn4200NotificationDesc = $4

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationACO"

            @AlertGroup = "Alarm Cutoff Status"
            @AlertKey = ""
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Alarm Cutoff Active"

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $1 + " )"
            details($cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc)

        case "52": ### cn4200NotificationUPM

            ##########
            # User payload mismatch.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $8 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $9 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationAffectedLP = $7
            $cn4200NotificationAffectedSourceIP = $8
            $cn4200NotificationHelperPEAID = $9

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationUPM"

            @AlertGroup = "User Payload Match Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "User Payload Mismatch"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( Affected LP: " + $7 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "53": ### cn4200NotificationAUTORESTART

            ##########
            # Automatic Reset
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationAUTORESTART"

            @AlertGroup = "Reset Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Automatic Reset  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "54": ### cn4200NotificationDEG

            ##########
            # Signal Degrade. Excessive bit error rate.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $5 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $6 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $7 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $8 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            $cn4200NotificationDesc = $4
            $cn4200NotificationHelperServiceIndicator = lookup($5, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationAffectedLP = $6
            $cn4200NotificationAffectedSourceIP = $7
            $cn4200NotificationHelperPEAID = $8

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationDEG"

            @AlertGroup = "Signal BER Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Signal Degrade, Excessive Bit Error Rate"
            switch($5)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( Affected LP: " + $6 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $5 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "55": ### cn4200NotificationINHMSG

            ##########
            # Autonomous messages inhibited.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationINHMSG"

            @AlertGroup = "Autonomous Message Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Autonomous Messages Inhibited  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "56": ### cn4200NotificationINTRUSION

            ##########
            # Intrusion Attempt Suspected.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationINTRUSION"

            @AlertGroup = "Intrusion Attempt Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Intrusion Attempt Suspected  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "57": ### cn4200NotificationRELMIG

            ##########
            # Release Migration.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationRELMIG"

            @AlertGroup = "Release Migration Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Release Migration  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "58": ### cn4200NotificationTUIDAGE

            ##########
            # User Account Inactivity Timeout.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationTUIDAGE"

            @AlertGroup = "User Account Activity Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "User Account Inactivity Timeout  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "59": ### cn4200NotificationCFGERR

            ##########
            # Configuration Error. Eg: Mismatch of power mod type during multi
            # single board configuration.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationCFGERR"

            @AlertGroup = "Configuration Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Configuration Error  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "60": ### cn4200NotificationPWRLOADBAL

            ##########
            # Power module load balance error.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationPWRLOADBAL"

            @AlertGroup = "Power Module Load Balance Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Power Module Load Balance Error  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "61": ### cn4200NotificationPWR

            ##########
            # Voltage threshold on power module.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $7 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $8 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationAffectedLP = $6
            $cn4200NotificationAffectedSourceIP = $7
            $cn4200NotificationHelperPEAID = $8

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationPWR"

            @AlertGroup = "Power Module Voltage Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Voltage Threshold on Power Module  ( Affected LP: " + $6 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "62": ### cn4200NotificationLOWTEMP

            ##########
            # Low temperature/cleared.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationHelperPEAID = $7

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationLOWTEMP"

            @AlertGroup = "Low Temperature Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Low Temperature"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationHelperPEAID)

        case "63": ### cn4200NotificationEXM

            ##########
            # Extension header mismatch.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $8 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $9 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationAffectedLP = $7
            $cn4200NotificationAffectedSourceIP = $8
            $cn4200NotificationHelperPEAID = $9

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationEXM"

            @AlertGroup = "Extension Header Match Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Extension Header Mismatch"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( Affected LP: " + $7 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "64": ### cn4200NotificationDATAFLT

            ##########
            # Unable to program firmware
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationHelperPEAID = $7

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationDATAFLT"

            @AlertGroup = "Firmware Program Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Unable to Program Firmware"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationHelperPEAID)

        case "65": ### cn4200NotificationINTMSGERR

            ##########
            # Internal message error.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationHelperPEAID = $7

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationINTMSGERR"

            @AlertGroup = "Internal Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Internal Message Error"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationHelperPEAID)

        case "66": ### cn4200NotificationLFD

            ##########
            # Loss of frame delineation.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $8 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $9 = cn4200NotificationHelperPEAID - Used in the variable binding
            #       of some gslamAG notification to indicate the AID of the
            #       entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationAffectedLP = $7
            $cn4200NotificationAffectedSourceIP = $8
            $cn4200NotificationHelperPEAID = $9

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationLFD"

            @AlertGroup = "Frame Delineation Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Loss of Frame Delineation"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( Affected LP: " + $7 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "67": ### cn4200NotificationALMCKT

            ##########
            # Alarm circuit failure.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationALMCKT"

            @AlertGroup = "Alarm Circuit Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Alarm Circuit Failure  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap

            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "68": ### cn4200NotificationFEED

            ##########
            # Dual power feed detected.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationFEED"

            @AlertGroup = "Dual Power Feed Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Dual Power Feed Detected  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap

            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "69": ### cn4200NotificationTIMPS

            ##########
            # Timing source protection switch.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationTIMPS"

            @AlertGroup = "Timing Source Protection Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Timing Source Protection Switch  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap

            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "70": ### cn4200NotificationSYNCPRI

            ##########
            # Loss of timing on primary synchronization link.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $7 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $8 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationAffectedLP = $6
            $cn4200NotificationAffectedSourceIP = $7
            $cn4200NotificationHelperPEAID = $8

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationSYNCPRI"

            @AlertGroup = "Primary Synchronization Link Timing Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Loss of Timing on Primary Synchronization Link  ( Affected LP: " + $6 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap

            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "71": ### cn4200NotificationSYNCSEC

            ##########
            # Loss of timing on secondary synchronization link.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $7 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $8 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationAffectedLP = $6
            $cn4200NotificationAffectedSourceIP = $7
            $cn4200NotificationHelperPEAID = $8

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationSYNCSEC"

            @AlertGroup = "Secondary Synchronization Link Timing Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Loss of Timing on Secondary Synchronization Link  ( Affected LP: " + $6 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap

            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "72": ### cn4200NotificationDCMFAIL

            ##########
            # DCM Connection Failure.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $8 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $9 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationAffectedLP = $7
            $cn4200NotificationAffectedSourceIP = $8
            $cn4200NotificationHelperPEAID = $9

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationDCMFAIL"

            @AlertGroup = "DCM Connection Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "DCM Connection Failure"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( Affected LP: " + $7 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap

            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "73": ### cn4200NotificationOPTPWRCNTRL

            ##########
            # Optical power level control failure.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $8 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $9 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationAffectedLP = $7
            $cn4200NotificationAffectedSourceIP = $8
            $cn4200NotificationHelperPEAID = $9


            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationOPTPWRCNTRL"

            @AlertGroup = "Optical Power Level Control Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Optical Power Level Control Failure"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( Affected LP: " + $7 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap

            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "74": ### cn4200NotificationTECCURRENT

            ##########
            # High laser TEC current.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $8 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $9 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationAffectedLP = $7
            $cn4200NotificationAffectedSourceIP = $8
            $cn4200NotificationHelperPEAID = $9

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationTECCURRENT"

            @AlertGroup = "Laser TEC Current Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Laser TEC Current High"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( Affected LP: " + $7 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap

            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "75": ### cn4200NotificationPUMPCURRENT

            ##########
            # High Laser Pump Current.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $8 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $9 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationAffectedLP = $7
            $cn4200NotificationAffectedSourceIP = $8
            $cn4200NotificationHelperPEAID = $9

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationPUMPCURRENT"

            @AlertGroup = "Laser Pump Current Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Laser Pump Current High"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( Affected LP: " + $7 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap

            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "76": ### cn4200NotificationLOFO

            ##########
            # Loss of frame, OSC.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationHelperPEAID = $7

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationLOFO"

            @AlertGroup = "OSC Frame Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "OSC Loss of Frame"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap

            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationHelperPEAID)

        case "77": ### cn4200NotificationLOSO

            ##########
            # Loss of Signal, OSC.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationHelperPEAID = $7

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationLOSO"

            @AlertGroup = "OSC Signal Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "OSC Loss of Signal"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap

            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationHelperPEAID)

        case "78": ### cn4200NotificationLOSP

            ##########
            # Loss of Signal, Payload.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationHelperPEAID = $7

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationLOSP"

            @AlertGroup = "Payload Signal Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Payload Loss of Signal"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap

            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationHelperPEAID)

        case "79": ### cn4200NotificationREMOTEFLT

            ##########
            # Remote fault ordered set.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperServiceIndicator - Used in the
            #        variable binding of some gslamAG notification to indicate
            #        the Service Indicator in the GSLAM-AG notification.
            # $7 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperServiceIndicator = lookup($6, cn4200NotificationHelperServiceIndicator)
            $cn4200NotificationHelperPEAID = $7

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationREMOTEFLT"

            @AlertGroup = "Remote Fault Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Remote Fault Ordered Set"
            switch($6)
            {
                case "1"|"2"|"3":
                    @Summary = @Summary + ", " + $cn4200NotificationHelperServiceIndicator
                default:
            }
            @Summary = @Summary + "  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap

            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationHelperServiceIndicator = $cn4200NotificationHelperServiceIndicator + " ( " + $6 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperServiceIndicator,$cn4200NotificationHelperPEAID)

        case "80": ### cn4200NotificationSYNCOOS

            ##########
            # Loss of timing on both Primary & secondary synchronization links
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationAffectedLP - Indicates the light path(s)
            #        affected by the alarm.
            # $7 = cn4200NotificationAffectedSourceIP - Indicates the light
            #        path(s) source IP affected by the alarm.
            # $8 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationAffectedLP = $6
            $cn4200NotificationAffectedSourceIP = $7
            $cn4200NotificationHelperPEAID = $8

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationSYNCOOS"

            @AlertGroup = "Pri. & Sec. Sync. Links Timing Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Loss of Timing on Primary & Secondary Synchronization Links  ( Affected LP: " + $6 + ", "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap

            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationAffectedLP,$cn4200NotificationAffectedSourceIP,$cn4200NotificationHelperPEAID)

        case "81": ### cn4200NotificationASDDISABLED

            ##########
            # Auto-laser shutdown disabled
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationASDDISABLED"

            @AlertGroup = "Auto-Laser Shutdown Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Auto-Laser Shutdown Disabled  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap

            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "82": ### cn4200NotificationSWTOPRI

            ##########
            # Synchronization switch to primary clock
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationSWTOPRI"

            @AlertGroup = "Primary Clock Synchronization Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Synchronization Switch to Primary Clock  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap

            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "83": ### cn4200NotificationSWTOSEC

            ##########
            # Synchronization switch to secondary clock
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationSWTOSEC"

            @AlertGroup = "Secondary Clock Synchronization Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Synchronization Switch to Secondary Clock  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap

            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "84": ### cn4200NotificationFRCDSWTOPRI

            ##########
            # Forced synchronization switch to primary clock
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationFRCDSWTOPRI"

            @AlertGroup = "Primary Clock Synchronization Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Forced Synchronization Switch to Primary Clock  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap

            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "85": ### cn4200NotificationFRCDSWTOSEC

            ##########
            # Forced synchronization switch to secondary clock
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationHelperAction - Used in the variable
            #        binding of some gslamAG notification to indicate the
            #        action in the GSLAM-AG notification.
            # $4 = cn4200NotificationHelperSev - Used in the variable binding
            #        of some gslamAG notification to indicate the severity in
            #        the GSLAM-AG notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            [$cn4200NotificationHelperAction,$Type] = lookup($3, cn4200NotificationHelperAction)
            $cn4200NotificationHelperAction = $cn4200NotificationHelperAction + " ( " + $3 + " )"
            [$cn4200NotificationHelperSev,$Severity] = lookup($4, cn4200NotificationHelperSev)
            $cn4200NotificationHelperSev = $cn4200NotificationHelperSev + " ( " + $4 + " )"
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200NotificationFRCDSWTOSEC"

            @AlertGroup = "Secondary Clock Synchronization Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Forced Synchronization Switch to Secondary Clock  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            if(match($Type, "2"))
            {
                @Summary = "End of " + @Summary
                $DEFAULT_Severity = 1
            }
            else
            {
                $DEFAULT_Severity = $Severity
            }
            $DEFAULT_Type = $Type
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap

            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationHelperAction,$cn4200NotificationHelperSev,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        default:

            @Summary = "Unknown Specific Trap Number (" + $specific-trap + ") Received for Enterprise " + $enterprise
            @Severity = 1
            @Identifier = @Node + " " + @Agent + " " + @Manager + " " + $enterprise + " " + $generic-trap + " " + $specific-trap
            details($*)
    }

    ##########
    # Handle Severity via Lookup.
    ##########
    
    #if(exists($SEV_KEY))
    #{
    #    [$OS_Severity,$OS_Type,$OS_ExpireTime] = lookup($SEV_KEY, ciena-IPI-GSLAMAG-MIB_sev)
    #}
    #else
    #{
    #    [$OS_Severity,$OS_Type,$OS_ExpireTime] = lookup($OS_EventId, ciena-IPI-GSLAMAG-MIB_sev)
    #}
    include "$NC_RULES_HOME/include-common/AssignSev.include.common.rules"
    
    ##########
    # End of Severity via Lookup.
    ##########
    
    ##########
    # Enter "Advanced" and "User" includes.
    ##########
    
    include "$NC_RULES_HOME/include-snmptrap/ciena/ciena-IPI-GSLAMAG-MIB_cn4200.adv.include.snmptrap.rules"
    include "$NC_RULES_HOME/include-snmptrap/ciena/ciena-IPI-GSLAMAG-MIB_cn4200.user.include.snmptrap.rules"
    
    ##########
    # End of "Advanced" and "User" includes.
    ##########

    include "$NC_RULES_HOME/include-common/load_include.rules"
    
    log(DEBUG, "<<<<< Leaving... ciena-IPI-GSLAMAG-MIB.include.snmptrap.rules >>>>>")

case ".1.3.6.1.4.1.7737.7.2.9.3.3": ### Ciena (formerly Internet Photonics) CN4200 GSLAM-AG - Notifications from IPI-GSLAMAG-MIB

    log(DEBUG, "<<<<< Entering... ciena-IPI-GSLAMAG-MIB.include.snmptrap.rules >>>>>")

    @Agent = "Ciena-CN4200 DB Change"
    @Class = "40506"

    $OPTION_TypeFieldUsage = "3.6"

    switch($specific-trap)
    {
        case "1": ### cn4200DBChangeNotificationsPLUGIN

            ##########
            # Configuration changed due to a plug in of equipment.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $4 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            $cn4200NotificationDesc = $3
            $cn4200NotificationHelperPEAID = $4

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsPLUGIN"

            @AlertGroup = "Equipment Plug Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Configuration Changed, Equipment Plugged In  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 13
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)

        case "2": ### cn4200DBChangeNotificationsUNPLUG

            ##########
            # Configuration changed due to an unplug of equipment.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $4 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            $cn4200NotificationDesc = $3
            $cn4200NotificationHelperPEAID = $4

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsUNPLUG"

            @AlertGroup = "Equipment Plug Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Configuration Changed, Equipment Unplugged  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 13
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)
            
        case "3": ### cn4200DBChangeNotificationsPE

            ##########
            # Configuration changed due to add/set/inh/alw of equipment.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationPEPrimaryState - Indicates the primary
            #        state of the physical entity involved in the notification.
            # $4 = cn4200NotificationPESecondaryState - Indicates the secondary
            #        state of the physical entity involved in the notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            $cn4200NotificationPEPrimaryState = lookup($3, cn4200PrimaryStateValue) + " ( " + $3 + " )"
            $cn4200NotificationPESecondaryState = lookup($4, cn4200SecondaryStateValue)
            $cn4200NotificationDesc = $5
            $cn4200NotificationHelperPEAID = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsPE"

            @AlertGroup = "Equipment Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            switch($3)
            {
                case "1": ### unknown
                    $SEV_KEY = $OS_EventId + "_unknown"
                    @Summary = @Summary + "Configuration Changed, Equipment Status Unknown"
    
                    $DEFAULT_Severity = 2
                    $DEFAULT_Type = 1
                    $DEFAULT_ExpireTime = 0
                case "2": ### is-nr
                    $SEV_KEY = $OS_EventId + "_is-nr"
                    @Summary = @Summary + "Configuration Changed, Equipment In-Service and Normal"
    
                    $DEFAULT_Severity = 1
                    $DEFAULT_Type = 2
                    $DEFAULT_ExpireTime = 0
                case "3": ### oos-au
                    $SEV_KEY = $OS_EventId + "_oos-au"
                    @Summary = @Summary + "Configuration Changed, Equipment Out-of-Service and Autonomous"
    
                    $DEFAULT_Severity = 3
                    $DEFAULT_Type = 1
                    $DEFAULT_ExpireTime = 0
                case "4": ### oos-ma
                    $SEV_KEY = $OS_EventId + "_oos-ma"
                    @Summary = @Summary + "Configuration Changed, Equipment Out-of-Service and Management"
    
                    $DEFAULT_Severity = 3
                    $DEFAULT_Type = 1
                    $DEFAULT_ExpireTime = 0
                case "5": ### oos-auma
                    $SEV_KEY = $OS_EventId + "_oos-auma"
                    @Summary = @Summary + "Configuration Changed, Equipment Out-of-Service and Autonomous Management"
    
                    $DEFAULT_Severity = 3
                    $DEFAULT_Type = 1
                    $DEFAULT_ExpireTime = 0
                default:
                    $SEV_KEY = $OS_EventId + "_unknown"
                    @Summary = @Summary + "Configuration Changed, Equipment Status Unknown"
    
                    $DEFAULT_Severity = 2
                    $DEFAULT_Type = 1
                    $DEFAULT_ExpireTime = 0
            }
            @Summary = @Summary + "  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }
            
            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $3 + " " + $4
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            $cn4200NotificationPESecondaryState = $cn4200NotificationPESecondaryState + " ( " + $4 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationPEPrimaryState,$cn4200NotificationPESecondaryState,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)
            
        case "4": ### cn4200DBChangeNotificationsRemPE

            ##########
            # Configuration changed due to removal of equipment.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $4 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            $cn4200NotificationDesc = $3
            $cn4200NotificationHelperPEAID = $4

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsRemPE"

            @AlertGroup = "Equipment Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Configuration Changed, Equipment Removed  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 1
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)
            
        case "5": ### cn4200DBChangeNotificationsSwitchPE

            ##########
            # Configuration changed due to a switch over of equipment.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationSwitchOverMode - Indicates the switch over
            #        mode of the protection switch notification.
            # $4 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $5 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            $cn4200NotificationSwitchOverMode = lookup($3, cn4200NotificationSwitchOverMode) + " ( " + $3 + " )"
            $cn4200NotificationDesc = $4
            $cn4200NotificationHelperPEAID = $5

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsSwitchPE"

            @AlertGroup = "Equipment Switchover Status"
            @AlertKey = "PE OID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            switch($3)
            {
                case "1": ### unknown
                    $SEV_KEY = $OS_EventId + "_unknown"
                    @Summary = @Summary + "Configuration Changed, Unknown Equipment Switchover  ( " + @AlertKey + " )"
    
                    $DEFAULT_Severity = 2
                    $DEFAULT_Type = 13
                    $DEFAULT_ExpireTime = 1800
                case "2": ### not-present
                    $SEV_KEY = $OS_EventId + "_not-present"
                    @Summary = @Summary + "Configuration Changed, Unknown Equipment Switchover  ( " + @AlertKey + " )"
    
                    $DEFAULT_Severity = 2
                    $DEFAULT_Type = 13
                    $DEFAULT_ExpireTime = 1800
                case "3": ### normal
                    $SEV_KEY = $OS_EventId + "_normal"
                    @Summary = @Summary + "Configuration Changed, Normal Equipment Switchover  ( " + @AlertKey + " )"
    
                    $DEFAULT_Severity = 2
                    $DEFAULT_Type = 13
                    $DEFAULT_ExpireTime = 1800
                case "4": ### forced
                    $SEV_KEY = $OS_EventId + "_forced"
                    @Summary = @Summary + "Configuration Changed, Forced Equipment Switchover  ( " + @AlertKey + " )"
    
                    $DEFAULT_Severity = 2
                    $DEFAULT_Type = 13
                    $DEFAULT_ExpireTime = 1800
                case "5": ### auto
                    $SEV_KEY = $OS_EventId + "_auto"
                    @Summary = @Summary + "Configuration Changed, Automatic Equipment Switchover  ( " + @AlertKey + " )"
    
                    $DEFAULT_Severity = 2
                    $DEFAULT_Type = 13
                    $DEFAULT_ExpireTime = 1800
                default:
                    $SEV_KEY = $OS_EventId + "_unknown"
                    @Summary = @Summary + "Configuration Changed, Unknown Equipment Switchover  ( " + @AlertKey + " )"
    
                    $DEFAULT_Severity = 2
                    $DEFAULT_Type = 13
                    $DEFAULT_ExpireTime = 1800
            }
            @Summary = @Summary + "  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $3
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationSwitchOverMode,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)
            
        case "6": ### cn4200DBChangeNotificationsProtPESetting

            ##########
            # Configuration changed due to set/delete physical entity fac
            # protection.
            #
            # $1 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $2 = cn4200NotificationSourceEqptAddr - Indicates the OID of the
            #        source equipment address involved in the notification.
            # $3 = cn4200NotificationDestEqptAddr - Indicates the OID of the
            #        destination equipment address involved in the
            #        notification.
            # $4 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            ##########

            $cn4200NotificationHelperPEType = lookup($1, cn4200EquipmentTypeValue)
            $cn4200NotificationSourceEqptAddr = $2
            $cn4200NotificationDestEqptAddr = $3
            $cn4200NotificationDesc = $4

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsProtPESetting"

            @AlertGroup = "Physical Entity Facility Protection Status"
            @AlertKey = "Source: " + $2 + ", Destination: " + $3
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Configuration Changed, Set/Delete Physical Entity Facility Protection  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 13
            $DEFAULT_ExpireTime = 1800

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $1 + " )"
            details($cn4200NotificationHelperPEType,$cn4200NotificationSourceEqptAddr,$cn4200NotificationDestEqptAddr,$cn4200NotificationDesc)
            
        case "7": ### cn4200DBChangeNotificationsProtPEConfig

            ##########
            # Configuration changed due to alw/inh physical entity fac
            # protection.
            #
            # $1 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $4 = cn4200NotificationHelperPEAID - Used in the variable binding
            #        of some gslamAG notification to indicate the AID of the
            #        entity involved in the notification.
            ##########

            $cn4200NotificationHelperPEOID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            $cn4200NotificationDesc = $3
            $cn4200NotificationHelperPEAID = $4

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsProtPEConfig"

            @AlertGroup = "Physical Entity Facility Protection Status"
            @AlertKey = "Source: " + $2 + ", Destination: " + $3
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Configuration Changed, Allow/Inhibit Physical Entity Facility Protection  ( "
            if(match($cn4200NotificationHelperPEAID, ""))
            {
                @Summary = @Summary + @AlertKey + " )"
            }
            else
            {
                @Summary = @Summary + "PE AID: " + $cn4200NotificationHelperPEAID + " )"
            }

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 13
            $DEFAULT_ExpireTime = 1800

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationHelperPEOID,$cn4200NotificationHelperPEType,$cn4200NotificationDesc,$cn4200NotificationHelperPEAID)
            
        case "8": ### cn4200DBChangeNotificationsCRS

            ##########
            # Configuration changed due to a cross connect of the equipment.
            #
            # $1 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $2 = cn4200NotificationSourceEqptAddr - Indicates the OID of the
            #        source equipment address involved in the notification.
            # $3 = cn4200NotificationDestEqptAddr - Indicates the OID of the
            #        destination equipment address involved in the
            #        notification.
            # $4 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            ##########

            $cn4200NotificationHelperPEType = lookup($1, cn4200EquipmentTypeValue)
            $cn4200NotificationSourceEqptAddr = $2
            $cn4200NotificationDestEqptAddr = $3
            $cn4200NotificationDesc = $4

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsCRS"

            @AlertGroup = "Equipment Cross-Connect Status"
            @AlertKey = "Source: " + $2 + ", Destination: " + $3
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Configuration Changed, Equipment Cross-Connected  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 13
            $DEFAULT_ExpireTime = 1800

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $1 + " )"
            details($cn4200NotificationHelperPEType,$cn4200NotificationSourceEqptAddr,$cn4200NotificationDestEqptAddr,$cn4200NotificationDesc)
            
        case "9": ### cn4200DBChangeNotificationsUpdSNMPTrapSvr

            ##########
            # An SNMP trap server has been added, modified, or deleted.
            #
            # $1 = snmpTrapServerIP - The IP address of the SNMP trap server.
            # $2 = snmpTrapServerVersion - The version number of the SNMP trap
            #        server.
            # $3 = snmpTrapServerCommunity - The community value of the SNMP
            #        trap server.
            # $4 = snmpTrapServerPort - The port number of the SNMP trap
            #        server.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            ##########

            $snmpTrapServerIP = $1
            $snmpTrapServerVersion = $2
            $snmpTrapServerCommunity = $3
            $snmpTrapServerPort = $4
            $cn4200NotificationDesc = $5

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsUpdSNMPTrapSvr"

            @AlertGroup = "SNMP Trap Server Status"
            @AlertKey = "snmpTrapServerEntry." + $1 + "." + $4
            @Summary = $5 + ", Version: " + $2 + ", Community: " + $3 + "  ( Trap Server: " + $1 + ", Port: " + $4 + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 13
            $DEFAULT_ExpireTime = 1800

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $5
            
            details($snmpTrapServerIP,$snmpTrapServerVersion,$snmpTrapServerCommunity,$snmpTrapServerPort,$cn4200NotificationDesc)

        case "10": ### cn4200DBChangeNotificationsUpdSNMPCommunity

            ##########
            # SNMP community updated.
            #
            # $1 = snmpServerCommunityHost - The IP address of the SNMP server
            #        community host.
            # $2 = snmpServerCommunityValue - The value of the SNMP server
            #        community.
            # $3 = snmpServerCommunityAccessType - The access type of the SNMP
            #        server community.
            # $4 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            ##########

            $snmpServerCommunityHost = $1
            $snmpServerCommunityValue = $2
            $snmpServerCommunityAccessType = lookup($3, cn4200SnmpServerCommunityAccessType)
            $cn4200NotificationDesc = $4

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsUpdSNMPCommunity"

            @AlertGroup = "SNMP Community Status"
            @AlertKey = "snmpServerCommunityEntry." + $1 + "." + $2
            switch($3)
            {
                case "2"|"3":
                    @Summary = "SNMP " + $snmpServerCommunityAccessType + " Community Changed to " + $2
                default:
                    @Summary = "SNMP Community Changed to " + $2
            }
            @Summary = @Summary + "  ( Host: " + $1 + " )"
            
            $DEFAULT_Severity = 2
            $DEFAULT_Type = 13
            $DEFAULT_ExpireTime = 1800

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $4
            
            $snmpServerCommunityAccessType = $snmpServerCommunityAccessType + " ( " + $3 + " )"
            details($snmpServerCommunityHost,$snmpServerCommunityValue,$snmpServerCommunityAccessType,$cn4200NotificationDesc)

        case "11": ### cn4200DBChangeNotificationsUpdNameSvr

            ##########
            # A name server has been added or deleted.
            #
            # $1 = nameServerIP - The IP address of the name server.
            # $2 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            ##########

            $nameServerIP = $1
            $cn4200NotificationDesc = $2

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsUpdNameSvr"

            @AlertGroup = "Name Server Status"
            @AlertKey = "nameServerEntry." + $1
            @Summary = $2 + "  ( Name Server: " + $1 + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 13
            $DEFAULT_ExpireTime = 1800

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $2
            
            details($nameServerIP,$cn4200NotificationDesc)

        case "12": ### cn4200DBChangeNotificationsUpdDNS

            ##########
            # A DNS server has been added or deleted.
            #
            # $1 = domainServerName - The domain name.
            # $2 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            ##########

            $domainServerName = $1
            $cn4200NotificationDesc = $2

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsUpdDNS"

            @AlertGroup = "DNS Server Status"
            @AlertKey = "domainServerEntry." + extract($OID1, "7737\.6\.2\.2\.2\.11\.3\.1\.1\.(.*)$")
            @Summary = $2 + "  ( DNS Server: " + $1 + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 13
            $DEFAULT_ExpireTime = 1800

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $2
            
            details($domainServerName,$cn4200NotificationDesc)

        case "13": ### cn4200DBChangeNotificationsUpdRadiusSvr

            ##########
            # Radius server added or modified.
            #
            # $1 = radiusServerIP - The IP address of the Radius server.
            # $2 = radiusServerSecret - The secret key used for the Radius
            #        server.
            # $3 = radiusServerTimeout - The timeout value associated with the
            #        Radius server.
            # $4 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            ##########

            $radiusServerIP = $1
            $radiusServerSecret = $2
            $radiusServerTimeout = $3
            $cn4200NotificationDesc = $4

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsUpdRadiusSvr"

            @AlertGroup = "Radius Server Status"
            @AlertKey = "radiusServerEntry." + $1
            @Summary = $4 + ", Secret Key: " + $2 + "  ( Radius Server: " + $1 + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 13
            $DEFAULT_ExpireTime = 1800

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $4
            
            details($radiusServerIP,$radiusServerSecret,$radiusServerTimeout,$cn4200NotificationDesc)

        case "14": ### cn4200DBChangeNotificationsDelRadiusSvr

            ##########
            # Radius server deleted.
            #
            # $1 = radiusServerIP - The IP address of the Radius server.
            # $2 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            ##########

            $radiusServerIP = $1
            $cn4200NotificationDesc = $2

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsDelRadiusSvr"

            @AlertGroup = "Radius Server Status"
            @AlertKey = "radiusServerEntry." + $1
            @Summary = $2 + "  ( Radius Server: " + $1 + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 13
            $DEFAULT_ExpireTime = 1800

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $2
            
            details($radiusServerIP,$cn4200NotificationDesc)

        case "15": ### cn4200DBChangeNotificationsUpdNTPSvr

            ##########
            # NTP server added or deleted.
            #
            # $1 = ntpServerIP - The IP address of the NTP server.
            # $2 = ntpServerKey - The key used for the NTP server.
            # $3 = ntpServerVersion - The version of the NTP server.
            # $4 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            ##########

            $ntpServerIP = $1
            $ntpServerKey = $2
            $ntpServerVersion = $3
            $cn4200NotificationDesc = $4

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsUpdNTPSvr"

            @AlertGroup = "NTP Server Status"
            @AlertKey = "ntpServerEntry." + $1
            @Summary = $4 + ", Key: " + $2 + ", Version: " + $3 + "  ( NTP Server: " + $1 + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 13
            $DEFAULT_ExpireTime = 1800

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $4
            
            details($ntpServerIP,$ntpServerKey,$ntpServerVersion,$cn4200NotificationDesc)

        case "16": ### cn4200DBChangeNotificationsDelNTPSvr

            ##########
            # NTP server deleted.
            #
            # $1 = ntpServerIP - The IP address of the NTP server.
            # $2 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            ##########

            $ntpServerIP = $1
            $cn4200NotificationDesc = $2

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsDelNTPSvr"

            @AlertGroup = "NTP Server Status"
            @AlertKey = "ntpServerEntry." + $1
            @Summary = $2 + "  ( NTP Server: " + $1 + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 13
            $DEFAULT_ExpireTime = 1800

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $2
            
            details($ntpServerIP,$cn4200NotificationDesc)

        case "17": ### cn4200DBChangeNotificationsUpdNTPAuthKey

            ##########
            # NTP authorization key updated.
            #
            # $1 = ntpAuthKeyId - The key used for the NTP server.
            # $2 = ntpAuthKeyValue - The key string of the NTP key entry.
            # $3 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            ##########

            $ntpAuthKeyId = $1
            $ntpAuthKeyValue = $2
            $cn4200NotificationDesc = $3

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsUpdNTPAuthKey"

            @AlertGroup = "NTP Authorization Key Status"
            @AlertKey = "ntpAuthKeyEntry." + $1
            @Summary = $3 + ", Key: " + $2 + "  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 13
            $DEFAULT_ExpireTime = 1800

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $3
            
            details($ntpAuthKeyId,$ntpAuthKeyValue,$cn4200NotificationDesc)

        case "18": ### cn4200DBChangeNotificationsDelNTPAuthKey

            ##########
            # NTP authorization key deleted.
            #
            # $1 = ntpAuthKeyId - The key used for the NTP server.
            # $2 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            ##########

            $ntpAuthKeyId = $1
            $cn4200NotificationDesc = $2

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsDelNTPAuthKey"

            @AlertGroup = "NTP Authorization Key Status"
            @AlertKey = "ntpAuthKeyEntry." + $1
            @Summary = $2 + "  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 13
            $DEFAULT_ExpireTime = 1800

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $2
            
            details($ntpAuthKeyId,$cn4200NotificationDesc)

        case "19": ### cn4200DBChangeNotificationsUpdNTPTrustKey

            ##########
            # NTP authority key updated.
            #
            # $1 = ntpTrustedKeyId - The key used for the NTP server.
            # $2 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            ##########

            $ntpTrustedKeyId = $1
            $cn4200NotificationDesc = $2

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsUpdNTPTrustKey"

            @AlertGroup = "NTP Authority Key Status"
            @AlertKey = "ntpTrustedKeyEntry." + $1
            @Summary = $2 + "  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 13
            $DEFAULT_ExpireTime = 1800

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $2
            
            details($ntpTrustedKeyId,$cn4200NotificationDesc)

        case "20": ### cn4200DBChangeNotificationsUpdTADRMap

            ##########
            # TADR map updated.
            #
            # $1 = gslamAGTAdrMapName - The name of this map entry.
            # $2 = gslamAGTAdrMapIP - The IP address of this map entry.
            # $3 = gslamAGTAdrMapPortNumber - The associated port number of
            #        this map entry.
            # $4 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            ##########

            $gslamAGTAdrMapName = $1
            $gslamAGTAdrMapIP = $2
            $gslamAGTAdrMapPortNumber = $3
            $cn4200NotificationDesc = $4

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsUpdTADRMap"

            @AlertGroup = "TADR Map Status"
            @AlertKey = "gslamAGTAdrMapEntry." + extract($OID1, "7737\.7\.2\.9\.2\.2\.4\.1\.1\.1\.(.*)$")
            @Summary = $4 + ", IP: " + $2 + ", Port" + $3 + "  ( TADR Map: " + $1 + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 13
            $DEFAULT_ExpireTime = 1800

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $4
            
            details($gslamAGTAdrMapName,$gslamAGTAdrMapIP,$gslamAGTAdrMapPortNumber,$cn4200NotificationDesc)

        case "21": ### cn4200DBChangeNotificationsDelTADRMap

            ##########
            # TADR map deleted.
            #
            # $1 = gslamAGTAdrMapName - The name of this map entry.
            # $2 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            ##########

            $gslamAGTAdrMapName = $1
            $cn4200NotificationDesc = $2

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsDelTADRMap"

            @AlertGroup = "TADR Map Status"
            @AlertKey = "gslamAGTAdrMapEntry." + extract($OID1, "7737\.7\.2\.9\.2\.2\.4\.1\.1\.1\.(.*)$")
            @Summary = $2 + "  ( TADR Map: " + $1 + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 13
            $DEFAULT_ExpireTime = 1800

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $2
            
            details($gslamAGTAdrMapName,$cn4200NotificationDesc)

        case "22": ### cn4200DBChangeNotificationsUpdECCRoute

            ##########
            # ECC route updated.
            #
            # $1 = cn4200NotificationHelperDestNetwork - Indicates the IP
            #        address the destination network.
            # $2 = cn4200NotificationHelperGateway - Indicates the gateway IP
            #        address.
            # $3 = cn4200NotificationHelperNetmask - Indicates the value of the
            #        network mask.
            # $4 = cn4200NotificationHelperMetric - Indicates the metric value
            #        of an ECC route.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            ##########

            $cn4200NotificationHelperDestNetwork = $1
            $cn4200NotificationHelperGateway = $2
            $cn4200NotificationHelperNetmask = $3
            $cn4200NotificationHelperMetric = $4
            $cn4200NotificationDesc = $5

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsUpdECCRoute"

            @AlertGroup = "ECC Route Status"
            @AlertKey = ""
            @Summary = $5 + ", Network: " + $1 + ", Netmask: " + $3 + ", Gateway: " + $2 + ", Metric: " + $4 + "  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 13
            $DEFAULT_ExpireTime = 1800

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $5
            
            details($cn4200NotificationHelperDestNetwork,$cn4200NotificationHelperGateway,$cn4200NotificationHelperNetmask,$cn4200NotificationHelperMetric,$cn4200NotificationDesc)

        case "23": ### cn4200DBChangeNotificationsUpdSID

            ##########
            # SID updated.
            #
            # $1 = cn4200NotificationHelperSID - Indicates the SID value of the
            #        NE.
            # $2 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            ##########

            $cn4200NotificationHelperSID = $1
            $cn4200NotificationDesc = $2

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200DBChangeNotificationsUpdSID"

            @AlertGroup = "SID Status"
            @AlertKey = ""
            @Summary = $2 + ", New SID: " + $1

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 13
            $DEFAULT_ExpireTime = 1800

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $2
            
            details($cn4200NotificationHelperSID,$cn4200NotificationDesc)
        
        default:

            @Summary = "Unknown Specific Trap Number (" + $specific-trap + ") Received for Enterprise " + $enterprise
            @Severity = 1
            @Identifier = @Node + " " + @Agent + " " + @Manager + " " + $enterprise + " " + $generic-trap + " " + $specific-trap
            details($*)
    }

    ##########
    # Handle Severity via Lookup.
    ##########
    
    #if(exists($SEV_KEY))
    #{
    #    [$OS_Severity,$OS_Type,$OS_ExpireTime] = lookup($SEV_KEY, ciena-IPI-GSLAMAG-MIB_sev)
    #}
    #else
    #{
    #    [$OS_Severity,$OS_Type,$OS_ExpireTime] = lookup($OS_EventId, ciena-IPI-GSLAMAG-MIB_sev)
    #}
    include "$NC_RULES_HOME/include-common/AssignSev.include.common.rules"
    
    ##########
    # End of Severity via Lookup.
    ##########
    
    ##########
    # Enter "Advanced" and "User" includes.
    ##########
    
    include "$NC_RULES_HOME/include-snmptrap/ciena/ciena-IPI-GSLAMAG-MIB_cn4200DBChange.adv.include.snmptrap.rules"
    include "$NC_RULES_HOME/include-snmptrap/ciena/ciena-IPI-GSLAMAG-MIB_cn4200DBChange.user.include.snmptrap.rules"
    
    ##########
    # End of "Advanced" and "User" includes.
    ##########
    
    include "$NC_RULES_HOME/include-common/load_include.rules"

    log(DEBUG, "<<<<< Leaving... ciena-IPI-GSLAMAG-MIB.include.snmptrap.rules >>>>>")

case ".1.3.6.1.4.1.7737.7.2.9.3.4": ### Ciena (formerly Internet Photonics) CN4200 GSLAM-AG - Notifications from IPI-GSLAMAG-MIB

    log(DEBUG, "<<<<< Entering... ciena-IPI-GSLAMAG-MIB.include.snmptrap.rules >>>>>")

    @Agent = "Ciena-CN4200 Set Fail"
    @Class = "40506"

    $OPTION_TypeFieldUsage = "3.6"

    switch($specific-trap)
    {
        case "1": ### gslamAGSetFailNotificationEntCRS

            ##########
            # Failed to enter a cross connect of the equipment.
            #
            # $1 = cn4200NotificationLPID - Indicates the light path ID
            #        management application provides when add/dlt crossconnect
            #        or protection group.
            # $2 = cn4200NotificationCktID - Indicates the circuit ID
            #        management application provides when add/dlt crossconnect.
            # $3 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $4 = cn4200NotificationSourceEqptAddr - Indicates the OID of the
            #        source equipment address involved in the notification.
            # $5 = cn4200NotificationDestEqptAddr - Indicates the OID of the
            #        destination equipment address involved in the
            #        notification.
            # $6 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $7 = cn4200NotificationFailureReason - Indicates the set failure
            #        reason.
            ##########

            $cn4200NotificationLPID = $1
            $cn4200NotificationCktID = $2
            $cn4200NotificationHelperPEType = lookup($3, cn4200EquipmentTypeValue)
            $cn4200NotificationSourceEqptAddr = $4
            $cn4200NotificationDestEqptAddr = $5
            $cn4200NotificationDesc = $6
            $cn4200NotificationFailureReason = $7

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-gslamAGSetFailNotificationEntCRS"

            @AlertGroup = "Equipment Cross Connect Status"
            @AlertKey = "Light Path ID: " + $1 + ", Circuit ID: " + $2
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Equipment Failed to Enter a Cross Connect, " + $7 +  "  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 3
            $DEFAULT_Type = 1
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $7
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $3 + " )"
            details($cn4200NotificationLPID,$cn4200NotificationCktID,$cn4200NotificationHelperPEType,$cn4200NotificationSourceEqptAddr,$cn4200NotificationDestEqptAddr,$cn4200NotificationDesc,$cn4200NotificationFailureReason)

        case "2": ### cn4200SetFailNotificationDelCRS

            ##########
            # Failed to delete a cross connect of the equipment.
            #
            # $1 = cn4200NotificationLPID - Indicates the light path ID
            #        management application provides when add/dlt crossconnect
            #        or protection group.
            # $2 = cn4200NotificationCktID - Indicates the circuit ID
            #        management application provides when add/dlt crossconnect.
            # $3 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $4 = cn4200NotificationSourceEqptAddr - Indicates the OID of the
            #        source equipment address involved in the notification.
            # $5 = cn4200NotificationDestEqptAddr - Indicates the OID of the
            #        destination equipment address involved in the
            #        notification.
            # $6 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $7 = cn4200NotificationFailureReason - Indicates the set failure
            #        reason.
            ##########

            $cn4200NotificationLPID = $1
            $cn4200NotificationCktID = $2
            $cn4200NotificationHelperPEType = lookup($3, cn4200EquipmentTypeValue)
            $cn4200NotificationSourceEqptAddr = $4
            $cn4200NotificationDestEqptAddr = $5
            $cn4200NotificationDesc = $6
            $cn4200NotificationFailureReason = $7

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200SetFailNotificationDelCRS"

            @AlertGroup = "Equipment Cross Connect Status"
            @AlertKey = "Light Path ID: " + $1 + ", Circuit ID: " + $2
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Equipment Failed to Delete a Cross Connect, " + $7 +  "  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 1
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $7
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $3 + " )"
            details($cn4200NotificationLPID,$cn4200NotificationCktID,$cn4200NotificationHelperPEType,$cn4200NotificationSourceEqptAddr,$cn4200NotificationDestEqptAddr,$cn4200NotificationDesc,$cn4200NotificationFailureReason)
            
        case "3": ### cn4200SetFailNotificationEdCRS

            ##########
            # Failed to edit a cross connect of the equipment.
            #
            # $1 = cn4200NotificationLPID - Indicates the light path ID
            #        management application provides when add/dlt crossconnect
            #        or protection group.
            # $2 = cn4200NotificationCktID - Indicates the circuit ID
            #        management application provides when add/dlt crossconnect.
            # $3 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $4 = cn4200NotificationSourceEqptAddr - Indicates the OID of the
            #        source equipment address involved in the notification.
            # $5 = cn4200NotificationDestEqptAddr - Indicates the OID of the
            #        destination equipment address involved in the
            #        notification.
            # $6 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $7 = cn4200NotificationFailureReason - Indicates the set failure
            #        reason.
            ##########

            $cn4200NotificationLPID = $1
            $cn4200NotificationCktID = $2
            $cn4200NotificationHelperPEType = lookup($3, cn4200EquipmentTypeValue)
            $cn4200NotificationSourceEqptAddr = $4
            $cn4200NotificationDestEqptAddr = $5
            $cn4200NotificationDesc = $6
            $cn4200NotificationFailureReason = $7

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200SetFailNotificationEdCRS"

            @AlertGroup = "Equipment Cross Connect Status"
            @AlertKey = "Light Path ID: " + $1 + ", Circuit ID: " + $2
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Equipment Failed to Edit a Cross Connect, " + $7 +  "  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 1
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $7
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $3 + " )"
            details($cn4200NotificationLPID,$cn4200NotificationCktID,$cn4200NotificationHelperPEType,$cn4200NotificationSourceEqptAddr,$cn4200NotificationDestEqptAddr,$cn4200NotificationDesc,$cn4200NotificationFailureReason)
            
        case "4": ### cn4200SetFailNotificationEntProt

            ##########
            # Failed to enter a protection group of the equipment.
            #
            # $1 = cn4200NotificationLPID - Indicates the light path ID
            #        management application provides when add/dlt crossconnect
            #        or protection group.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationSourceEqptAddr - Indicates the OID of the
            #        source equipment address involved in the notification.
            # $4 = cn4200NotificationDestEqptAddr - Indicates the OID of the
            #        destination equipment address involved in the
            #        notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationFailureReason - Indicates the set failure
            #        reason.
            ##########

            $cn4200NotificationLPID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            $cn4200NotificationSourceEqptAddr = $3
            $cn4200NotificationDestEqptAddr = $4
            $cn4200NotificationDesc = $5
            $cn4200NotificationFailureReason = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200SetFailNotificationEntProt"

            @AlertGroup = "Equipment Protection Group Status"
            @AlertKey = "Light Path ID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Equipment Failed to Enter a Protection Group, " + $6 +  "  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 3
            $DEFAULT_Type = 1
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $6
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationLPID,$cn4200NotificationHelperPEType,$cn4200NotificationSourceEqptAddr,$cn4200NotificationDestEqptAddr,$cn4200NotificationDesc,$cn4200NotificationFailureReason)
            
        case "5": ### cn4200SetFailNotificationDelProt

            ##########
            # Failed to delete a protection group of the equipment.
            #
            # $1 = cn4200NotificationLPID - Indicates the light path ID
            #        management application provides when add/dlt crossconnect
            #        or protection group.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationSourceEqptAddr - Indicates the OID of the
            #        source equipment address involved in the notification.
            # $4 = cn4200NotificationDestEqptAddr - Indicates the OID of the
            #        destination equipment address involved in the
            #        notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationFailureReason - Indicates the set failure
            #        reason.
            ##########

            $cn4200NotificationLPID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            $cn4200NotificationSourceEqptAddr = $3
            $cn4200NotificationDestEqptAddr = $4
            $cn4200NotificationDesc = $5
            $cn4200NotificationFailureReason = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200SetFailNotificationDelProt"

            @AlertGroup = "Equipment Protection Group Status"
            @AlertKey = "Light Path ID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Equipment Failed to Delete a Protection Group, " + $6 +  "  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 1
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $6
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationLPID,$cn4200NotificationHelperPEType,$cn4200NotificationSourceEqptAddr,$cn4200NotificationDestEqptAddr,$cn4200NotificationDesc,$cn4200NotificationFailureReason)
            
        case "6": ### cn4200SetFailNotificationEdProt

            ##########
            # Failed to edit a protection group of the equipment.
            #
            # $1 = cn4200NotificationLPID - Indicates the light path ID
            #        management application provides when add/dlt crossconnect
            #        or protection group.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationSourceEqptAddr - Indicates the OID of the
            #        source equipment address involved in the notification.
            # $4 = cn4200NotificationDestEqptAddr - Indicates the OID of the
            #        destination equipment address involved in the
            #        notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationFailureReason - Indicates the set failure
            #        reason.
            ##########

            $cn4200NotificationLPID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            $cn4200NotificationSourceEqptAddr = $3
            $cn4200NotificationDestEqptAddr = $4
            $cn4200NotificationDesc = $5
            $cn4200NotificationFailureReason = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200SetFailNotificationEdProt"

            @AlertGroup = "Equipment Protection Group Status"
            @AlertKey = "Light Path ID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Equipment Failed to Edit a Protection Group, " + $6 +  "  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 1
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $6
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationLPID,$cn4200NotificationHelperPEType,$cn4200NotificationSourceEqptAddr,$cn4200NotificationDestEqptAddr,$cn4200NotificationDesc,$cn4200NotificationFailureReason)
            
        case "7": ### cn4200SetFailNotificationProtSwitch

            ##########
            # Failed to perform protection switch.
            #
            # $1 = cn4200NotificationLPID - Indicates the light path ID
            #        management application provides when add/dlt crossconnect
            #        or protection group.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationSourceEqptAddr - Indicates the OID of the
            #        source equipment address involved in the notification.
            # $4 = cn4200NotificationDestEqptAddr - Indicates the OID of the
            #        destination equipment address involved in the
            #        notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationFailureReason - Indicates the set failure
            #        reason.
            ##########

            $cn4200NotificationLPID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            $cn4200NotificationSourceEqptAddr = $3
            $cn4200NotificationDestEqptAddr = $4
            $cn4200NotificationDesc = $5
            $cn4200NotificationFailureReason = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200SetFailNotificationProtSwitch"

            @AlertGroup = "Protection Switch Status"
            @AlertKey = "Light Path ID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Failed to Perform Protection Switch, " + $6 + "  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 3
            $DEFAULT_Type = 1
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + $6
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationLPID,$cn4200NotificationHelperPEType,$cn4200NotificationSourceEqptAddr,$cn4200NotificationDestEqptAddr,$cn4200NotificationDesc,$cn4200NotificationFailureReason)
            
        case "8": ### cn4200SetFailNotificationAlwSwDx

            ##########
            # Failed to allow duplex switching.
            #
            # $1 = cn4200NotificationLPID - Indicates the light path ID
            #        management application provides when add/dlt crossconnect
            #        or protection group.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationSourceEqptAddr - Indicates the OID of the
            #        source equipment address involved in the notification.
            # $4 = cn4200NotificationDestEqptAddr - Indicates the OID of the
            #        destination equipment address involved in the
            #        notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationFailureReason - Indicates the set failure
            #        reason.
            ##########

            $cn4200NotificationLPID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            $cn4200NotificationSourceEqptAddr = $3
            $cn4200NotificationDestEqptAddr = $4
            $cn4200NotificationDesc = $5
            $cn4200NotificationFailureReason = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200SetFailNotificationAlwSwDx"

            @AlertGroup = "Duplex Switching Status"
            @AlertKey = "Light Path ID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Failed to Allow Duplex Switching, " + $6 + "  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 3
            $DEFAULT_Type = 1
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $6
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationLPID,$cn4200NotificationHelperPEType,$cn4200NotificationSourceEqptAddr,$cn4200NotificationDestEqptAddr,$cn4200NotificationDesc,$cn4200NotificationFailureReason)
            
        case "9": ### cn4200SetFailNotificationInhSwDx

            ##########
            # Failed to inhibit duplex switching.
            #
            # $1 = cn4200NotificationLPID - Indicates the light path ID
            #        management application provides when add/dlt crossconnect
            #        or protection group.
            # $2 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $3 = cn4200NotificationSourceEqptAddr - Indicates the OID of the
            #        source equipment address involved in the notification.
            # $4 = cn4200NotificationDestEqptAddr - Indicates the OID of the
            #        destination equipment address involved in the
            #        notification.
            # $5 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $6 = cn4200NotificationFailureReason - Indicates the set failure
            #        reason.
            ##########

            $cn4200NotificationLPID = $1
            $cn4200NotificationHelperPEType = lookup($2, cn4200EquipmentTypeValue)
            $cn4200NotificationSourceEqptAddr = $3
            $cn4200NotificationDestEqptAddr = $4
            $cn4200NotificationDesc = $5
            $cn4200NotificationFailureReason = $6

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200SetFailNotificationInhSwDx"

            @AlertGroup = "Duplex Switching Status"
            @AlertKey = "Light Path ID: " + $1
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Failed to Inhibit Duplex Switching, " + $6 + "  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 3
            $DEFAULT_Type = 1
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $6
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $2 + " )"
            details($cn4200NotificationLPID,$cn4200NotificationHelperPEType,$cn4200NotificationSourceEqptAddr,$cn4200NotificationDestEqptAddr,$cn4200NotificationDesc,$cn4200NotificationFailureReason)
            
        case "10": ### cn4200SetFailNotificationInitSys

            ##########
            # Failed to perform system init.
            #
            # $1 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $2 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $3 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $4 = cn4200NotificationFailureReason - Indicates the set failure
            #        reason.
            ##########

            $cn4200NotificationHelperPEType = lookup($1, cn4200EquipmentTypeValue)
            $cn4200NotificationHelperPEOID = $2
            $cn4200NotificationDesc = $3
            $cn4200NotificationFailureReason = $4

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200SetFailNotificationInitSys"

            @AlertGroup = "System Initialization Status"
            @AlertKey = "PE OID: " + $2
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Failed to Perform System Initialization, " + $4 + "  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 3
            $DEFAULT_Type = 1
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $4
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $1 + " )"
            details($cn4200NotificationHelperPEType,$cn4200NotificationHelperPEOID,$cn4200NotificationDesc,$cn4200NotificationFailureReason)
            
        case "11": ### cn4200SetFailNotificationEntEqpt

            ##########
            # Failed to enter an equipment object.
            #
            # $1 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $2 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $3 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $4 = cn4200NotificationFailureReason - Indicates the set failure
            #        reason.
            ##########

            $cn4200NotificationHelperPEType = lookup($1, cn4200EquipmentTypeValue)
            $cn4200NotificationHelperPEOID = $2
            $cn4200NotificationDesc = $3
            $cn4200NotificationFailureReason = $4

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200SetFailNotificationEntEqpt"

            @AlertGroup = "Equipment Object Status"
            @AlertKey = "PE OID: " + $2
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Failed to Enter an Equipment Object, " + $4 + "  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 1
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $4
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $1 + " )"
            details($cn4200NotificationHelperPEType,$cn4200NotificationHelperPEOID,$cn4200NotificationDesc,$cn4200NotificationFailureReason)
            
        case "12": ### cn4200SetFailNotificationDelEqpt

            ##########
            # Failed to delete an equipment object.
            #
            # $1 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $2 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $3 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $4 = cn4200NotificationFailureReason - Indicates the set failure
            #        reason.
            ##########

            $cn4200NotificationHelperPEType = lookup($1, cn4200EquipmentTypeValue)
            $cn4200NotificationHelperPEOID = $2
            $cn4200NotificationDesc = $3
            $cn4200NotificationFailureReason = $4

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200SetFailNotificationDelEqpt"

            @AlertGroup = "Equipment Object Status"
            @AlertKey = "PE OID: " + $2
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Failed to Delete an Equipment Object, " + $4 + "  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 1
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $4
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $1 + " )"
            details($cn4200NotificationHelperPEType,$cn4200NotificationHelperPEOID,$cn4200NotificationDesc,$cn4200NotificationFailureReason)
            
        case "13": ### cn4200SetFailNotificationEdEqpt

            ##########
            # Failed to edit an equipment object.
            #
            # $1 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $2 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $3 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $4 = cn4200NotificationFailureReason - Indicates the set failure
            #        reason.
            ##########

            $cn4200NotificationHelperPEType = lookup($1, cn4200EquipmentTypeValue)
            $cn4200NotificationHelperPEOID = $2
            $cn4200NotificationDesc = $3
            $cn4200NotificationFailureReason = $4

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200SetFailNotificationEdEqpt"

            @AlertGroup = "Equipment Object Status"
            @AlertKey = "PE OID: " + $2
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Failed to Edit an Equipment Object, " + $4 + "  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 1
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $4
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $1 + " )"
            details($cn4200NotificationHelperPEType,$cn4200NotificationHelperPEOID,$cn4200NotificationDesc,$cn4200NotificationFailureReason)
            
        case "14": ### cn4200SetFailNotificationRmvEqpt

            ##########
            # Failed to place an equipment object in a maintenance state.
            #
            # $1 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $2 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $3 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $4 = cn4200NotificationFailureReason - Indicates the set failure
            #        reason.
            ##########

            $cn4200NotificationHelperPEType = lookup($1, cn4200EquipmentTypeValue)
            $cn4200NotificationHelperPEOID = $2
            $cn4200NotificationDesc = $3
            $cn4200NotificationFailureReason = $4

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200SetFailNotificationRmvEqpt"

            @AlertGroup = "Equipment Object Status"
            @AlertKey = "PE OID: " + $2
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Failed to Place an Equipment Object in Maintenance, " + $4 + "  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 1
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $4
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $1 + " )"
            details($cn4200NotificationHelperPEType,$cn4200NotificationHelperPEOID,$cn4200NotificationDesc,$cn4200NotificationFailureReason)
            
        case "15": ### cn4200SetFailNotificationRstEqpt

            ##########
            # Failed to place an equipment object in an in-service state.
            #
            # $1 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $2 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $3 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $4 = cn4200NotificationFailureReason - Indicates the set failure
            #        reason.
            ##########

            $cn4200NotificationHelperPEType = lookup($1, cn4200EquipmentTypeValue)
            $cn4200NotificationHelperPEOID = $2
            $cn4200NotificationDesc = $3
            $cn4200NotificationFailureReason = $4

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200SetFailNotificationRstEqpt"

            @AlertGroup = "Equipment Object Status"
            @AlertKey = "PE OID: " + $2
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Failed to Place an Equipment Object In-Service, " + $4 + "  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 1
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $4
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $1 + " )"
            details($cn4200NotificationHelperPEType,$cn4200NotificationHelperPEOID,$cn4200NotificationDesc,$cn4200NotificationFailureReason)
            
        case "16": ### cn4200SetFailNotificationOprLpbk

            ##########
            # Failed to configure a loopback on the specified object.
            #
            # $1 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $2 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $3 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $4 = cn4200NotificationFailureReason - Indicates the set failure
            #        reason.
            ##########

            $cn4200NotificationHelperPEType = lookup($1, cn4200EquipmentTypeValue)
            $cn4200NotificationHelperPEOID = $2
            $cn4200NotificationDesc = $3
            $cn4200NotificationFailureReason = $4

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200SetFailNotificationOprLpbk"

            @AlertGroup = "Object Loopback Status"
            @AlertKey = "PE OID: " + $2
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Failed to Configure a Loopback, " + $4 + "  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 1
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $4
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $1 + " )"
            details($cn4200NotificationHelperPEType,$cn4200NotificationHelperPEOID,$cn4200NotificationDesc,$cn4200NotificationFailureReason)
            
        case "17": ### cn4200SetFailNotificationRlsLpbk

            ##########
            # Failed to release a loopback on the specified object.
            #
            # $1 = cn4200NotificationHelperPEType - Used in the variable
            #        binding of some gslamAG notification to indicate the type
            #        of the physical entity involved in the GSLAM-AG
            #        notification.
            # $2 = cn4200NotificationHelperPEOID - Used in the variable binding
            #        of some gslamAG notification to indicate the OID of the
            #        physical entity OR it is the IOD of user for security
            #        related alarms involved in the GSLAM-AG notification.
            # $3 = cn4200NotificationDesc - Indicates the detailed description
            #        of the gslamAG notification.
            # $4 = cn4200NotificationFailureReason - Indicates the set failure
            #        reason.
            ##########

            $cn4200NotificationHelperPEType = lookup($1, cn4200EquipmentTypeValue)
            $cn4200NotificationHelperPEOID = $2
            $cn4200NotificationDesc = $3
            $cn4200NotificationFailureReason = $4

            $OS_EventId = "SNMPTRAP-ciena-IPI-GSLAMAG-MIB-cn4200SetFailNotificationRlsLpbk"

            @AlertGroup = "Object Loopback Status"
            @AlertKey = "PE OID: " + $2
            if(!match($cn4200NotificationHelperPEType, "Unknown"))
            {
                @Summary = $cn4200NotificationHelperPEType + " "
            }
            @Summary = @Summary + "Failed to Release a Loopback, " + $4 + "  ( " + @AlertKey + " )"

            $DEFAULT_Severity = 2
            $DEFAULT_Type = 1
            $DEFAULT_ExpireTime = 0

            @Identifier = @Node + " " + @AlertKey + " " + @AlertGroup + " " + $DEFAULT_Type + " " + @Agent + " " + @Manager + " " + $specific-trap + " " + $4
            
            $cn4200NotificationHelperPEType = $cn4200NotificationHelperPEType + " ( " + $1 + " )"
            details($cn4200NotificationHelperPEType,$cn4200NotificationHelperPEOID,$cn4200NotificationDesc,$cn4200NotificationFailureReason)
            
        default:

            @Summary = "Unknown Specific Trap Number (" + $specific-trap + ") Received for Enterprise " + $enterprise
            @Severity = 1
            @Identifier = @Node + " " + @Agent + " " + @Manager + " " + $enterprise + " " + $generic-trap + " " + $specific-trap
            details($*)
    }

    ##########
    # Handle Severity via Lookup.
    ##########
    
    #if(exists($SEV_KEY))
    #{
    #    [$OS_Severity,$OS_Type,$OS_ExpireTime] = lookup($SEV_KEY, ciena-IPI-GSLAMAG-MIB_sev)
    #}
    #else
    #{
    #    [$OS_Severity,$OS_Type,$OS_ExpireTime] = lookup($OS_EventId, ciena-IPI-GSLAMAG-MIB_sev)
    #}
    include "$NC_RULES_HOME/include-common/AssignSev.include.common.rules"
    
    ##########
    # End of Severity via Lookup.
    ##########
    
    ##########
    # Enter "Advanced" and "User" includes.
    ##########
    
    include "$NC_RULES_HOME/include-snmptrap/ciena/ciena-IPI-GSLAMAG-MIB_cn4200SetFail.adv.include.snmptrap.rules"
    include "$NC_RULES_HOME/include-snmptrap/ciena/ciena-IPI-GSLAMAG-MIB_cn4200SetFail.user.include.snmptrap.rules"
    
    ##########
    # End of "Advanced" and "User" includes.
    ##########
    
    include "$NC_RULES_HOME/include-common/load_include.rules"

    log(DEBUG, "<<<<< Leaving... ciena-IPI-GSLAMAG-MIB.include.snmptrap.rules >>>>>")
