#############################################################################
#
#		cmg_opcon.include.rules
#
#		Netcool Mttrapd Rules Include File for CMG SMSC.
#		This is based upon CMG OPCON Agent MIB
#
#	V0.0	20100401	Original						Chris Janes of Innovise-ESM	
#
#############################################################################

case ".1.3.6.1.4.1.3830.1.1.2.2.2":	#
    log(DEBUG, "<<<<< Entering... cmg_opcom..include.rules >>>>>")
    @Agent = "CMG-OPCOM-MIB"
    $enterpriseName = "opcomAgent"
    @Class = "100007"
    @OmcEms = $PeerIPaddress
    
    $OS_ExpireTime = 600
    $OPTION_TypeFieldUsage = "3.6"
@URL = "ST = " + $specific-trap + " 1= " + $1 + " 2= " + $2 + " 3= " + $3 + " 4= " + $4 + " 5= " + $5 + " 6= " + $6
###
# Added to set Node for Mobilink
# Giles Blake, 13/07/10
###

@Node = $6 + "/" + $4
update(@Severity)

###
# End, 13/07/10
###
    switch($specific-trap)
    {

        case "10": ### internalOpcomTrap
						
				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3 
				$trapTimeStamp = $4

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
				@Summary = $trapData
#				@Summary =  "Internal status information of the agent"
				@AlertGroup=$trapNotificationId
				@AlertKey=$trapData



#
# OPCOM specific traps
#
        case "50": ###     internalOpcomIndeterminateTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapTimeStamp = $4

				@Summary = $trapData
#				@Summary = "Internal trap generated by the OPCOM SNMP subagent "
				@AlertGroup=$trapNotificationId
				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)



#
# OPCOM specific traps
#

        case "51": ###     internalOpcomCriticalTrap  TRAP-TYPE



				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapTimeStamp = $4

				@Summary = $trapData
#				@Summary = "Internal trap generated by the OPCOM SNMP subagent "
				@AlertGroup=$trapNotificationId

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)

#
# OPCOM specific traps
#
        case "52": ###     internalOpcomMajorTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapTimeStamp = $4

				@Summary = $trapData
#				@Summary = "Internal trap generated by the OPCOM SNMP subagent "
				@AlertGroup=$trapNotificationId

					[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
#
# OPCOM specific traps
#
        case "53": ###     internalOpcomMinorTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapTimeStamp = $4

				@Summary = $trapData
#				@Summary = "Internal trap generated by the OPCOM SNMP subagent "
				@AlertGroup=$trapNotificationId
				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)


        case "54": ###     internalOpcomWarningTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapTimeStamp = $4

				@Summary = $trapData
#				@Summary = "Internal trap generated by the OPCOM SNMP subagent "
				@AlertGroup=$trapNotificationId
 
				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)


        case "55": ###     internalOpcomClearTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapTimeStamp = $4

				@Summary = $trapData
#				@Summary = "Internal trap generated by the OPCOM SNMP subagent "
				@AlertGroup=$trapNotificationId

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)




        case "110": ###     externalOpcomIndeterminateTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapEntityName = $4
				$trapTimeStamp = $5
				$trapNodeName = $6
				$trapProbableCause = $7
				$trapEventType = $8
				$trapSpecificProblem = $9

				@Summary = $trapData
#				@Summary = "External trap from OPCOM SNMP subagent, this trap is received from the OPCOM service."
				@AlertGroup=$trapNotificationId
				@AlertKey=$trapEntityName
 
				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
				$OS_X733ProbableCauseText = lookup($trapProbableCause, smsctrapProbableCause)
				$AlarmTypeValue = lookup($trapEventType, smsctrapEventType)
				@EventType = $AlarmTypeValue
				$SpecificProblemValue = lookup($trapSpecificProblem, smsctrapSpecificProblem)


        case "111": ###     externalOpcomCriticalTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapEntityName = $4
				$trapTimeStamp = $5
				$trapNodeName = $6
				$trapProbableCause = $7
				$trapEventType = $8
				$trapSpecificProblem = $9

				@Summary = $trapData
#				@Summary = "External trap from OPCOM SNMP subagent, this trap is received from the OPCOM service."
				@AlertGroup=$trapNotificationId
				@AlertKey=$trapEntityName

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
				$OS_X733ProbableCauseText = lookup($trapProbableCause, smsctrapProbableCause)
				$AlarmTypeValue = lookup($trapEventType, smsctrapEventType)
				@EventType = $AlarmTypeValue
				$SpecificProblemValue = lookup($trapSpecificProblem, smsctrapSpecificProblem)


        case "112": ###     externalOpcomMajorTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapEntityName = $4
				$trapTimeStamp = $5
				$trapNodeName = $6
				$trapProbableCause = $7
				$trapEventType = $8
				$trapSpecificProblem = $9

				@Summary = $trapData
#				@Summary = "External trap from OPCOM SNMP subagent, this trap is received from the OPCOM service."
				@AlertGroup=$trapNotificationId
				@AlertKey=$trapEntityName

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
				$OS_X733ProbableCauseText = lookup($trapProbableCause, smsctrapProbableCause)
				$AlarmTypeValue = lookup($trapEventType, smsctrapEventType)
				@EventType = $AlarmTypeValue
				$SpecificProblemValue = lookup($trapSpecificProblem, smsctrapSpecificProblem)


        case "113": ###     externalOpcomMinorTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapEntityName = $4
				$trapTimeStamp = $5
				$trapNodeName = $6
				$trapProbableCause = $7
				$trapEventType = $8
				$trapSpecificProblem = $9

				@Summary = $trapData
#				@Summary = "External trap from OPCOM SNMP subagent, this trap is received from the OPCOM service."
				@AlertGroup=$trapNotificationId
				@AlertKey=$trapEntityName

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
				$OS_X733ProbableCauseText = lookup($trapProbableCause, smsctrapProbableCause)
				$AlarmTypeValue = lookup($trapEventType, smsctrapEventType)
				@EventType = $AlarmTypeValue
				$SpecificProblemValue = lookup($trapSpecificProblem, smsctrapSpecificProblem)


        case "114": ###     externalOpcomWarningTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapEntityName = $4
				$trapTimeStamp = $5
				$trapNodeName = $6
				$trapProbableCause = $7
				$trapEventType = $8
				$trapSpecificProblem = $9

				@Summary = $trapData
#				@Summary = "External trap from OPCOM SNMP subagent, this trap is received from the OPCOM service."
				@AlertGroup=$trapNotificationId
				@AlertKey=$trapEntityName

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
				$OS_X733ProbableCauseText = lookup($trapProbableCause, smsctrapProbableCause)
				$AlarmTypeValue = lookup($trapEventType, smsctrapEventType)
				@EventType = $AlarmTypeValue
				$SpecificProblemValue = lookup($trapSpecificProblem, smsctrapSpecificProblem)


        case "115": ###     externalOpcomClearTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapEntityName = $4
				$trapTimeStamp = $5
				$trapNodeName = $6
				$trapProbableCause = $7
				$trapEventType = $8
				$trapSpecificProblem = $9

				@Summary = $trapData
#				@Summary = "External trap from OPCOM SNMP subagent, this trap is received from the OPCOM service."
				@AlertGroup=$trapNotificationId
				@AlertKey=$trapEntityName

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
				$OS_X733ProbableCauseText = lookup($trapProbableCause, smsctrapProbableCause)
				$AlarmTypeValue = lookup($trapEventType, smsctrapEventType)
				@EventType = $AlarmTypeValue
				$SpecificProblemValue = lookup($trapSpecificProblem, smsctrapSpecificProblem)





#
# IPR 38073:
# The following trap definitions are subsets from the external traps:
#

#
# The following trap describes the unknown external traps without a VMS tag
#
        case "998": ###     notagOpcomTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapEntityName = $4
				$trapTimeStamp = $5
				$trapNodeName = $6
				$trapProbableCause = $7
				$trapEventType = $8
				$trapSpecificProblem = $9

				$tmpText = extract($trapData, "^Message from user .* on [0-9a-zA-Z]*  (.*) ")
				$tmpInt = split($tmpText, SplitArray, " ")
				@AddText = $trapData
#				@AlertGroup=$trapNotificationId
				@AlertGroup=extract($trapData, "^Message from user (.*) on .*$")
#				@AlertKey=$trapEntityName
				@AlertKey=SplitArray[1]
#				@Summary = $trapData
				@Summary = $tmpText

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
				$OS_X733ProbableCauseText = lookup($trapProbableCause, smsctrapProbableCause)
				$AlarmTypeValue = lookup($trapEventType, smsctrapEventType)
				@EventType = $AlarmTypeValue
				$SpecificProblemValue = lookup($trapSpecificProblem, smsctrapSpecificProblem)
details($*)

        case "9980": ###   notagOpcomIndeterminateTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapEntityName = $4
				$trapTimeStamp = $5
				$trapNodeName = $6
				$trapProbableCause = $7
				$trapEventType = $8
				$trapSpecificProblem = $9

				@Summary = $trapData
#				@Summary = "External trap from OPCOM subagent which has the unknown tag"
				@AlertGroup=$trapNotificationId
				@AlertKey=$trapEntityName

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
				$OS_X733ProbableCauseText = lookup($trapProbableCause, smsctrapProbableCause)
				$AlarmTypeValue = lookup($trapEventType, smsctrapEventType)
				@EventType = $AlarmTypeValue
				$SpecificProblemValue = lookup($trapSpecificProblem, smsctrapSpecificProblem)


        case "9981": ###     notagOpcomCriticalTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapEntityName = $4
				$trapTimeStamp = $5
				$trapNodeName = $6
				$trapProbableCause = $7
				$trapEventType = $8
				$trapSpecificProblem = $9

				@Summary = $trapData
#				@Summary = "External trap from OPCOM subagent which has the unknown tag"
				@AlertGroup=$trapNotificationId
				@AlertKey=$trapEntityName

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
				$OS_X733ProbableCauseText = lookup($trapProbableCause, smsctrapProbableCause)
				$AlarmTypeValue = lookup($trapEventType, smsctrapEventType)
				@EventType = $AlarmTypeValue
				$SpecificProblemValue = lookup($trapSpecificProblem, smsctrapSpecificProblem)


        case "9982": ###     notagOpcomMajorTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapEntityName = $4
				$trapTimeStamp = $5
				$trapNodeName = $6
				$trapProbableCause = $7
				$trapEventType = $8
				$trapSpecificProblem = $9

				@Summary = $trapData
#				@Summary = "External trap from OPCOM subagent which has the unknown tag"
				@AlertGroup=$trapNotificationId
				@AlertKey=$trapEntityName

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
				$OS_X733ProbableCauseText = lookup($trapProbableCause, smsctrapProbableCause)
				$AlarmTypeValue = lookup($trapEventType, smsctrapEventType)
				@EventType = $AlarmTypeValue
				$SpecificProblemValue = lookup($trapSpecificProblem, smsctrapSpecificProblem)


        case "9983": ###   notagOpcomMinorTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapEntityName = $4
				$trapTimeStamp = $5
				$trapNodeName = $6
				$trapProbableCause = $7
				$trapEventType = $8
				$trapSpecificProblem = $9

				@Summary = $trapData
#				@Summary = "External trap from OPCOM subagent which has the unknown tag"
				@AlertGroup=$trapNotificationId
				@AlertKey=$trapEntityName

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
				$OS_X733ProbableCauseText = lookup($trapProbableCause, smsctrapProbableCause)
				$AlarmTypeValue = lookup($trapEventType, smsctrapEventType)
				@EventType = $AlarmTypeValue
				$SpecificProblemValue = lookup($trapSpecificProblem, smsctrapSpecificProblem)


        case "9984": ###     notagOpcomWarningTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapEntityName = $4
				$trapTimeStamp = $5
				$trapNodeName = $6
				$trapProbableCause = $7
				$trapEventType = $8
				$trapSpecificProblem = $9

				@Summary = $trapData
#				@Summary = "External trap from OPCOM subagent which has the unknown tag"
				@AlertGroup=$trapNotificationId
				@AlertKey=$trapEntityName

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
				$OS_X733ProbableCauseText = lookup($trapProbableCause, smsctrapProbableCause)
				$AlarmTypeValue = lookup($trapEventType, smsctrapEventType)
				@EventType = $AlarmTypeValue
				$SpecificProblemValue = lookup($trapSpecificProblem, smsctrapSpecificProblem)


        case "9985": ###     notagOpcomClearTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapEntityName = $4
				$trapTimeStamp = $5
				$trapNodeName = $6
				$trapProbableCause = $7
				$trapEventType = $8
				$trapSpecificProblem = $9

				@Summary = $trapData
#				@Summary = "External trap from OPCOM subagent which has the unknown tag"
				@AlertGroup=$trapNotificationId
				@AlertKey=$trapEntityName

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
				$OS_X733ProbableCauseText = lookup($trapProbableCause, smsctrapProbableCause)
				@EventType = $AlarmTypeValue
				$AlarmTypeValue = lookup($trapEventType, smsctrapEventType)
				@EventType = $AlarmTypeValue
				$SpecificProblemValue = lookup($trapSpecificProblem, smsctrapSpecificProblem)


#
# Unassigned OPCOM traps will receive the following trap identity (default)
# 
        case "999": ###     unknownOpcomTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapEntityName = $4
				$trapTimeStamp = $5
				$trapNodeName = $6
				$trapProbableCause = $7
				$trapEventType = $8
				$trapSpecificProblem = $9

				@Summary = $trapData
#				@Summary = "External trap from OPCOM subagent which is unknown"
				@AlertGroup=$trapNotificationId
				@AlertKey=$trapEntityName

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
				$OS_X733ProbableCauseText = lookup($trapProbableCause, smsctrapProbableCause)
				$AlarmTypeValue = lookup($trapEventType, smsctrapEventType)
				@EventType = $AlarmTypeValue
				$SpecificProblemValue = lookup($trapSpecificProblem, smsctrapSpecificProblem)


        case "9990": ###     unknownOpcomIndeterminateTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapEntityName = $4
				$trapTimeStamp = $5
				$trapNodeName = $6
				$trapProbableCause = $7
				$trapEventType = $8
				$trapSpecificProblem = $9

				@Summary = $trapData
#				@Summary = "External trap from OPCOM subagent which is unknown"
				@AlertGroup=$trapNotificationId
				@AlertKey=$trapEntityName

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
				$OS_X733ProbableCauseText = lookup($trapProbableCause, smsctrapProbableCause)
				$AlarmTypeValue = lookup($trapEventType, smsctrapEventType)
				@EventType = $AlarmTypeValue
				$SpecificProblemValue = lookup($trapSpecificProblem, smsctrapSpecificProblem)


        case "9991": ###     unknownOpcomCriticalTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapEntityName = $4
				$trapTimeStamp = $5
				$trapNodeName = $6
				$trapProbableCause = $7
				$trapEventType = $8
				$trapSpecificProblem = $9

				@Summary = $trapData
#				@Summary = "External trap from OPCOM subagent which is unknown"
				@AlertGroup=$trapNotificationId
				@AlertKey=$trapEntityName

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
				$OS_X733ProbableCauseText = lookup($trapProbableCause, smsctrapProbableCause)
				$AlarmTypeValue = lookup($trapEventType, smsctrapEventType)
				@EventType = $AlarmTypeValue
				$SpecificProblemValue = lookup($trapSpecificProblem, smsctrapSpecificProblem)


        case "9992": ###     unknownOpcomMajorTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapEntityName = $4
				$trapTimeStamp = $5
				$trapNodeName = $6
				$trapProbableCause = $7
				$trapEventType = $8
				$trapSpecificProblem = $9

				@Summary = $trapData
#				@Summary = "External trap from OPCOM subagent which is unknown"
				@AlertGroup=$trapNotificationId
				@AlertKey=$trapEntityName

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
				$OS_X733ProbableCauseText = lookup($trapProbableCause, smsctrapProbableCause)
				$AlarmTypeValue = lookup($trapEventType, smsctrapEventType)
				@EventType = $AlarmTypeValue
				$SpecificProblemValue = lookup($trapSpecificProblem, smsctrapSpecificProblem)


        case "9993": ###     unknownOpcomMinorTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapEntityName = $4
				$trapTimeStamp = $5
				$trapNodeName = $6
				$trapProbableCause = $7
				$trapEventType = $8
				$trapSpecificProblem = $9

				@Summary = $trapData
#				@Summary = "External trap from OPCOM subagent which is unknown"
				@AlertGroup=$trapNotificationId
				@AlertKey=$trapEntityName

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
				$OS_X733ProbableCauseText = lookup($trapProbableCause, smsctrapProbableCause)
				$AlarmTypeValue = lookup($trapEventType, smsctrapEventType)
				@EventType = $AlarmTypeValue
				$SpecificProblemValue = lookup($trapSpecificProblem, smsctrapSpecificProblem)


        case "9994": ###     unknownOpcomWarningTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapEntityName = $4
				$trapTimeStamp = $5
				$trapNodeName = $6
				$trapProbableCause = $7
				$trapEventType = $8
				$trapSpecificProblem = $9

				@Summary = $trapData
#				@Summary = "External trap from OPCOM subagent which is unknown"
				@AlertGroup=$trapNotificationId
				@AlertKey=$trapEntityName

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
				$OS_X733ProbableCauseText = lookup($trapProbableCause, smsctrapProbableCause)
				$AlarmTypeValue = lookup($trapEventType, smsctrapEventType)
				@EventType = $AlarmTypeValue
				$SpecificProblemValue = lookup($trapSpecificProblem, smsctrapSpecificProblem)


        case "9995": ###     unknownOpcomClearTrap  TRAP-TYPE


				$trapNotificationId = $1
				$trapSeverity = $2
				$trapData = $3
				$trapEntityName = $4
				$trapTimeStamp = $5
				$trapNodeName = $6
				$trapProbableCause = $7
				$trapEventType = $8
				$trapSpecificProblem = $9

				@Summary = $trapData
#				@Summary = "External trap from OPCOM subagent which is unknown"
				@AlertGroup=$trapNotificationId
				@AlertKey=$trapEntityName

				[$OS_Severity, $OS_Type, $OS_ExpireTime] = lookup($trapSeverity, SeverityValue)
				$OS_X733ProbableCauseText = lookup($trapProbableCause, smsctrapProbableCause)
				$AlarmTypeValue = lookup($trapEventType, smsctrapEventType)
				@EventType = $AlarmTypeValue
				$SpecificProblemValue = lookup($trapSpecificProblem, smsctrapSpecificProblem)



		default:
			$OS_Severity = 1
			$OS_Type =0
			@AlertGroup="CMG-OPCOM-MIB"
			@AlertKey=$specific-trap
			@Identifier = @Node + @AlertGroup + @AlertKey
			@Summary = "Unknown Event from CMG-OPCOM-MIB, Specific Trap " + @AlertKey
			@URL = "1 = " + $1 + " 2 = " + $2 + " 3 = " + $3 + " 4 = " + $4 + " 5 = " + $5 + " 6 = " + $6 + " 7 = " + $7 + "8 = " + $8 
			details($*)
			
}

		@Severity = $OS_Severity
		@Type = $OS_Type
		@Grade = $specific-trap

@Identifier = @Node + " " + $enterprise + " " + $generic-trap + " " + $specific-trap + " " + @AlertGroup + " " + @AlertKey + " " + @Agent + " " + @Manager + $OS_Type
$OS_X733ProbableCause = $trapProbableCause
$OS_X733EventType = $trapEventType
#@$OS_X733SpecificProblem = $trapSpecificProblem
@EventType = $AlarmTypeValue
@Network = 4
update(@Summary )
details($*)

